---
title: "Forecasting Project"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r}
# Read the data

library(readr)

Projectdata <- read_csv("/Users/patrick/Documents/UniversitaÌˆt/Master/DSBA/Year_2/T1/Forecasting & Predictive Analytics/Project/Project and data-20220107/Projectdata.csv")

Projectdata

```

Exercise 1 - Assessing the data and univariate benchmarks

Exercise 1.1 - Are these six variables stationary,

(a) using a simple method, e.g. looking at the time series plots and at the ACF/PACF?

```{r}
# Time series Plot
# Libraries
library(ggplot2)
library(dplyr)

# Hobbies
ggplot(Projectdata, aes(x=Projectdata$date, y=Projectdata$Hobbies_CA_1)) +
    geom_line(color="#69b3a2") +
    ylab("Hoobies CA_1")
ggplot(Projectdata, aes(x=Projectdata$date, y=Projectdata$Hobbies_CA_2)) +
    geom_line(color="#69b3a2") +
    ylab("Hoobies CA_2")
ggplot(Projectdata, aes(x=Projectdata$date, y=Projectdata$Hobbies_CA_3)) +
    geom_line(color="#69b3a2") +
    ylab("Hoobies CA_3")

# Household 1
ggplot(Projectdata, aes(x=Projectdata$date, y=Projectdata$Household_1_CA_1)) +
    geom_line(color="#69b3a2") +
    ylab("Household_1 CA_1")
ggplot(Projectdata, aes(x=Projectdata$date, y=Projectdata$Household_1_CA_2)) +
    geom_line(color="#69b3a2") +
    ylab("Household_1 CA_2")
ggplot(Projectdata, aes(x=Projectdata$date, y=Projectdata$Household_1_CA_3)) +
    geom_line(color="#69b3a2") +
    ylab("Household_1 CA_3")

# Household 2
ggplot(Projectdata, aes(x=Projectdata$date, y=Projectdata$Household_2_CA_1)) +
    geom_line(color="#69b3a2") +
    ylab("Household_2 CA_1")
ggplot(Projectdata, aes(x=Projectdata$date, y=Projectdata$Household_2_CA_2)) +
    geom_line(color="#69b3a2") +
    ylab("Household_2 CA_2")
ggplot(Projectdata, aes(x=Projectdata$date, y=Projectdata$Household_2_CA_3)) +
    geom_line(color="#69b3a2") +
    ylab("Household_2 CA_3")

# Food 1
ggplot(Projectdata, aes(x=Projectdata$date, y=Projectdata$Foods_1_CA_1)) +
    geom_line(color="#69b3a2") +
    ylab("Foods_1 CA_1")
ggplot(Projectdata, aes(x=Projectdata$date, y=Projectdata$Foods_1_CA_2)) +
    geom_line(color="#69b3a2") +
    ylab("Foods_1 CA_2")
ggplot(Projectdata, aes(x=Projectdata$date, y=Projectdata$Foods_1_CA_3)) +
    geom_line(color="#69b3a2") +
    ylab("Foods_1 CA_3")

# Food 2
ggplot(Projectdata, aes(x=Projectdata$date, y=Projectdata$Foods_2_CA_1)) +
    geom_line(color="#69b3a2") +
    ylab("Foods_2 CA_1")
ggplot(Projectdata, aes(x=Projectdata$date, y=Projectdata$Foods_2_CA_2)) +
    geom_line(color="#69b3a2") +
    ylab("Foods_2 CA_2")
ggplot(Projectdata, aes(x=Projectdata$date, y=Projectdata$Foods_2_CA_3)) +
    geom_line(color="#69b3a2") +
    ylab("Foods_2 CA_3")

# Food 3
ggplot(Projectdata, aes(x=Projectdata$date, y=Projectdata$Foods_3_CA_1)) +
    geom_line(color="#69b3a2") +
    ylab("Foods_3 CA_1")
ggplot(Projectdata, aes(x=Projectdata$date, y=Projectdata$Foods_3_CA_2)) +
    geom_line(color="#69b3a2") +
    ylab("Foods_3 CA_2")
ggplot(Projectdata, aes(x=Projectdata$date, y=Projectdata$Foods_3_CA_3)) +
    geom_line(color="#69b3a2") +
    ylab("Foods_3 CA_3")



```
```{r}
# ACF Hobbies Plot
acf(Projectdata$Hobbies_CA_1, main = 'Hoobies ACF CA_1', lag.max= 20)
acf(Projectdata$Hobbies_CA_2, main = 'Hoobies ACF CA_2', lag.max= 20)
acf(Projectdata$Hobbies_CA_3, main = 'Hoobies ACF CA_3', lag.max= 20)

# PACF Hobbies
pacf(Projectdata$Hobbies_CA_1, main = 'Hoobies PACF CA_1', lag.max= 20)
pacf(Projectdata$Hobbies_CA_2, main = 'Hoobies PACF CA_2', lag.max= 20)
pacf(Projectdata$Hobbies_CA_3, main = 'Hoobies PACF CA_3', lag.max= 20)


```

```{r}
# Household

# PACF & ACF Household_1
acf(Projectdata$Household_1_CA_1, main = 'Household1 ACF CA_1', lag.max= 100)
acf(Projectdata$Household_1_CA_2, main = 'Household1 ACF CA_2', lag.max= 100)
acf(Projectdata$Household_1_CA_3, main = 'Household1 ACF CA_3', lag.max= 100)

pacf(Projectdata$Household_1_CA_1, main = 'Household1 PACF CA_1', lag.max= 100)
pacf(Projectdata$Household_1_CA_2, main = 'Household1 PACF CA_2', lag.max= 100)
pacf(Projectdata$Household_1_CA_3, main = 'Household1 PACF CA_2', lag.max= 100)

# PACF & ACF Household_2
acf(Projectdata$Household_2_CA_1, main = "Household2 ACF CA_1", lag.max = 100)
acf(Projectdata$Household_2_CA_2, main = "Household2 ACF CA_2", lag.max = 100)
acf(Projectdata$Household_2_CA_3, main = "Household2 ACF CA_3", lag.max = 100)

pacf(Projectdata$Household_2_CA_1, main = "Household2 PACF CA_1", lag.max = 100)
pacf(Projectdata$Household_2_CA_2, main = "Household2 PACF CA_2", lag.max = 100)
pacf(Projectdata$Household_2_CA_3, main = "Household2 PACF CA_3", lag.max = 100)


```

```{r}
# Food 

# ACF & PACF Foods1
acf(Projectdata$Foods_1_CA_1, main = 'Foods1 ACF CA_1', lag.max = 100)
acf(Projectdata$Foods_1_CA_2, main = 'Foods1 ACF CA_2', lag.max = 100)
acf(Projectdata$Foods_1_CA_3, main = 'Foods1 ACF CA_3', lag.max = 100)

pacf(Projectdata$Foods_1_CA_1, main = 'Foods1 PACF CA_1', lag.max = 100)
pacf(Projectdata$Foods_1_CA_2, main = 'Foods1 PACF CA_2', lag.max = 100)
pacf(Projectdata$Foods_1_CA_3, main = 'Foods1 PACF CA_3', lag.max = 100)

# ACF & PACF Foods2
acf(Projectdata$Foods_2_CA_1, main = 'Foods2 ACF CA_1', lag.max = 100)
acf(Projectdata$Foods_2_CA_2, main = 'Foods2 ACF CA_2', lag.max = 100)
acf(Projectdata$Foods_2_CA_3, main = 'Foods2 ACF CA_3', lag.max = 100)

pacf(Projectdata$Foods_2_CA_1, main = 'Foods2 PACF CA_1', lag.max = 100)
pacf(Projectdata$Foods_2_CA_2, main = 'Foods2 PACF CA_2', lag.max = 100)
pacf(Projectdata$Foods_2_CA_3, main = 'Foods2 PACF CA_3', lag.max = 100)

# ACF & PACF Food3
acf(Projectdata$Foods_3_CA_1, main = 'Foods3 ACF CA_1', lag.max = 100)
acf(Projectdata$Foods_3_CA_2, main = 'Foods3 ACF CA_2', lag.max = 100)
acf(Projectdata$Foods_3_CA_3, main = 'Foods3 ACF CA_3', lag.max = 100)

pacf(Projectdata$Foods_3_CA_1, main = 'Foods3 PACF CA_1', lag.max = 100)
pacf(Projectdata$Foods_3_CA_2, main = 'Foods3 PACF CA_2', lag.max = 100)
pacf(Projectdata$Foods_3_CA_3, main = 'Foods3 PACF CA_3', lag.max = 100)
```

a) After plotting the ACF and PACF of all the series at hand, we can see from the ACF plots of all categories that the slow decrease in the graph that is extending beyond 100 lag indicates a trend in the underlying data. Thus, using the simple method of analyzing the time series plots as well as the plots of the ACF, we assume that the six variables are not stationary. Additionally the scalloped shape indicates seasonality. 

(b) performing a test?

```{r}
# Running Tests on the data 

# Hobbies

# to choose between trend, drift or none, we again first take a look at the plotted data

library(urca)
x1 <- Projectdata$Hobbies_CA_1
x2 <- Projectdata$Hobbies_CA_2
x3 <- Projectdata$Hobbies_CA_3

plot(y = x1,x = Projectdata$date, type = "S")
plot(y = x2, x = Projectdata$date, type="S")
plot(y = x3, x = Projectdata$date, type="S",)

# Hobbies CA_1, drift
summary(ur.df(x1,type="drift", selectlags = c("AIC")))
# Hobbies CA_2, trend
summary(ur.df(x2,type="trend", selectlags = c("AIC")))
# Hobbies CA_3, trend
summary(ur.df(x3,type="drift", selectlags = c("AIC")))

```

```{r}

# HouseHold 1

# to choose between trend, drift or none, we again first take a look at the plotted data

library(urca)
x1 <- Projectdata$Household_1_CA_1
x2 <- Projectdata$Household_1_CA_2
x3 <- Projectdata$Household_1_CA_3

plot(y = x1, x = Projectdata$date, type = "S")
plot(y = x2, x = Projectdata$date, type="S")
plot(y = x3, x = Projectdata$date, type="S")

# House1_CA_1, trend
summary(ur.df(x1,type="trend", selectlags = c("AIC")))
# House1_CA_2, trend
summary(ur.df(x2,type="trend", selectlags = c("AIC")))
# House1_CA_3, trend
summary(ur.df(x3,type="trend", selectlags = c("AIC")))



```
```{r}

# HouseHold 2
x1 <- Projectdata$Household_2_CA_1
x2 <- Projectdata$Household_2_CA_2
x3 <- Projectdata$Household_2_CA_3

plot(y = x1, x = Projectdata$date, type = "S")
plot(y = x2, x = Projectdata$date, type="S")
plot(y = x3, x = Projectdata$date, type="S")

# House2_CA_1, trend
summary(ur.df(x1,type="trend", selectlags = c("AIC")))
# House2_CA_2, trend
summary(ur.df(x2,type="trend", selectlags = c("AIC")))
# House2_CA_3, trend
summary(ur.df(x3,type="trend", selectlags = c("AIC")))

```
```{r}

# Foods 1
x1 <- Projectdata$Foods_1_CA_1
x2 <- Projectdata$Foods_1_CA_2
x3 <- Projectdata$Foods_1_CA_3

plot(y = x1, x = Projectdata$date, type = "S")
plot(y = x2, x = Projectdata$date, type="S")
plot(y = x3, x = Projectdata$date, type="S")

# Food1_CA_1, none
summary(ur.df(x1, selectlags = c("AIC")))
# Food1_CA_2, drift
summary(ur.df(x2,type="drift", selectlags = c("AIC")))
# Food1_CA_3, trend (we need to choose)
summary(ur.df(x3,type="trend", selectlags = c("AIC")))

```
```{r}
# Foods 2
x1 <- Projectdata$Foods_2_CA_1
x2 <- Projectdata$Foods_2_CA_2
x3 <- Projectdata$Foods_2_CA_3

plot(y = x1, x = Projectdata$date, type = "S")
plot(y = x2, x = Projectdata$date, type="S")
plot(y = x3, x = Projectdata$date, type="S")

# Food2_CA_1, we need to check between drift and trend
summary(ur.df(x1, selectlags = c("AIC")))
# Food2_CA_2, drift
summary(ur.df(x2,type="drift", selectlags = c("AIC")))
# Food2_CA_3, drift
summary(ur.df(x3,type="drift", selectlags = c("AIC")))

```
```{r}
# Foods 3
x1 <- Projectdata$Foods_3_CA_1
x2 <- Projectdata$Foods_3_CA_2
x3 <- Projectdata$Foods_3_CA_3

plot(y = x1, x = Projectdata$date, type = "S")
plot(y = x2, x = Projectdata$date, type="S")
plot(y = x3, x = Projectdata$date, type="S")

# Food3_CA_1, we need to check between drift and trend
summary(ur.df(x1,type="trend", selectlags = c("AIC")))
# Food3_CA_2, drift
summary(ur.df(x2,type="drift", selectlags = c("AIC")))
# Food3_CA_3, we need to check between drift and trend
summary(ur.df(x3,type="drift", selectlags = c("AIC")))

```

Exercise 1.2 - We now want to assess the set of benchmark in the M5 guidelines. For several sample splits of your choice,

(a) Fit Statistical benchmarks 1 (Naive), 2 (sNaive), 3 (ES), 4 (MA), 13 (ESX), as well as SARIMA, SARIMAX (using X as in ESX) and Holt-Winters up to the end of the training subsample.

```{r}
require(smooth)
require(greybox)
library(xts)
library(tseries)
library(TSA)
library(forecast)
library(fpp3)
#df_tsbl <- Projectdata #%>%
  #mutate(date = as_date(date)) %>%
  #as_tsibble(index = date)
#dim(df_tsbl) # 1969, 22

# array of features' names - for possible for loop
colnames = colnames(Projectdata) # all column names

ex_variables_n = tail(colnames,n=3) # only explanatory variable names

x_variables_n = colnames[-c(1)]
x_variables_n = x_variables_n[c(1:18)] # without explanatory and date

# train, val, test dataframes
df_train = Projectdata[c(1:1941), c(1:22)]
# df_val = df_tsbl[c(1914:1941), c(1:22)]
df_test = Projectdata[c(1942:1969), c(1:22)]

```

```{r}
library(lubridate)
library(forecast)
library(ggplot2)
Projectdata

# Forecasting Hobbies 
# create a time series for the HC1 data
HC1 <- ts(Projectdata$Hobbies_CA_1, start= c(2011,01, 29), frequency = 365)
HC1
time = time(HC1)

# validation set is 10% of the data set
n.valid <- 197
n.train <- length(HC1) - n.valid

HC1.train.ts <- window(HC1, start=time[1], end=time[n.train])
HC1.valid.ts <- window(HC1, start=time[n.train+1], end=time[n.train+n.valid])
HC1.train.ts

# Naive Hobbies 1 Cali1
naive.HC1 = naive(HC1.train.ts, h= 28)
naive.HC1$mean
naive.HC1_df = data.frame(naive.HC1)
rownames(naive.HC1_df) = date_decimal(as.numeric(rownames(naive.HC1_df)))
acc.naive.HC1 <- accuracy(naive.HC1, HC1.valid.ts)
knitr::kable(acc.naive.HC1)

# Seasonal Naive Hobbies 1 Cali1
snaive.HC1 = snaive(HC1.train.ts, h =28)
snaive.HC1$mean
snaive.HC1_df = data.frame(snaive.HC1)
snaive.HC1_df
rownames(snaive.HC1_df) = date_decimal(as.numeric(rownames(snaive.HC1_df)))
acc.snaive.HC1 <- accuracy(snaive.HC1, HC1.valid.ts)
knitr::kable(acc.snaive.HC1)
summary(snaive.HC1)
# Exponential Smoothing 
es.HC1 = ses(HC1.train.ts, h = 28)
es.HC1$mean
es.HC1_df <- data.frame(es.HC1)
es.HC1_df
rownames(es.HC1_df) <- date_decimal(as.numeric(rownames(es.HC1_df)))
acc.es.HC1 <- accuracy(es.HC1, HC1.valid.ts)
knitr::kable(acc.es.HC1)


# Moving Average
ma.HC1 <- forecast(ma(HC1.train.ts, order = 5), h = 28)
ma.HC1$mean
ma.HC1_df <- data.frame(ma.HC1)
rownames(ma.HC1_df) <- date_decimal(as.numeric(rownames(ma.HC1_df)))
acc.ma.HC1 <- accuracy(ma.HC1, HC1.valid.ts)
knitr::kable(acc.ma.HC1)

# SARIMA
sarima.HC1 <- forecast(auto.arima(HC1.train.ts, D = 1), h = 28)
sarima.HC1$mean
sarima.HC1_df <- data.frame(sarima.HC1)
rownames(sarima.HC1_df) <- date_decimal(as.numeric(rownames(sarima.HC1_df)))
acc.sarima.HC1 <- accuracy(sarima.HC1, HC1.valid.ts)
knitr::kable(acc.sarima.HC1)

# HoltWinters
hw.HC1 <- forecast(HoltWinters(HC1.train.ts, seasonal = "additive"), h = 28)
hw.HC1$mean
hw.HC1.df <- data.frame(hw.HC1)
rownames(hw.HC1.df) <- date_decimal(as.numeric(rownames(hw.HC1.df)))
acc.hw.HC1 <- accuracy(hw.HC1, HC1.valid.ts)
knitr::kable(acc.hw.HC1)

# State Space (Tbats)
tbats.HC1 <- forecast(tbats(HC1.train.ts), h = 28)
tbats.HC1$mean
tbats.HC1.df <- data.frame(tbats.HC1)
rownames(tbats.HC1.df) <- date_decimal(as.numeric(rownames(tbats.HC1.df)))
acc.tbats.HC1 <- accuracy(tbats.HC1, HC1.valid.ts)
knitr::kable(acc.tbats.HC1)
```


```{r}
library(lubridate)
library(forecast)
library(ggplot2)
Projectdata

# Forecasting Hobbies 
# create a time series for the HC2 data
HC2 <- ts(Projectdata$Hobbies_CA_2, start= c(2011,01, 29), frequency = 365)

time = time(HC2)

# validation set is 10% of the data set
n.valid <- 197
n.train <- length(HC2) - n.valid

HC2.train.ts <- window(HC2, start=time[1], end=time[n.train])
HC2.valid.ts <- window(HC2, start=time[n.train+1], end=time[n.train+n.valid])


# Naive Hobbies 
naive.HC2 = naive(HC2.train.ts, h= 28)
naive.HC2$mean
naive.HC2_df = data.frame(naive.HC2)
rownames(naive.HC2_df) = date_decimal(as.numeric(rownames(naive.HC2_df)))
acc.naive.HC2 <- accuracy(naive.HC2, HC2.valid.ts)
knitr::kable(acc.naive.HC2)

# Seasonal Naive Hobbies 
snaive.HC2 = snaive(HC2.train.ts, h =28)
snaive.HC2$mean
snaive.HC2_df = data.frame(snaive.HC2)
rownames(snaive.HC2_df) = date_decimal(as.numeric(rownames(snaive.HC2_df)))
acc.snaive.HC2 <- accuracy(snaive.HC2, HC2.valid.ts)
knitr::kable(acc.snaive.HC2)

# Exponential Smoothing 
es.HC2 = ses(HC2.train.ts, h = 28)
es.HC2$mean
es.HC2_df <- data.frame(es.HC2)
rownames(es.HC2_df) <- date_decimal(as.numeric(rownames(es.HC2_df)))
acc.es.HC2 <- accuracy(es.HC2, HC2.valid.ts)
knitr::kable(acc.es.HC2)

# Moving Average
ma.HC2 <- forecast(ma(HC2.train.ts, order = 5), h = 28)
ma.HC2$mean
ma.HC2_df <- data.frame(ma.HC2)
rownames(ma.HC2_df) <- date_decimal(as.numeric(rownames(ma.HC2_df)))
acc.ma.HC2 <- accuracy(ma.HC2, HC2.valid.ts)
knitr::kable(acc.ma.HC2)

# SARIMA
sarima.HC2 <- forecast(auto.arima(HC2.train.ts, D = 1), h = 28)
sarima.HC2$mean
sarima.HC2_df <- data.frame(sarima.HC2)
rownames(sarima.HC2_df) <- date_decimal(as.numeric(rownames(sarima.HC2_df)))
acc.sarima.HC2 <- accuracy(sarima.HC2, HC2.valid.ts)
knitr::kable(acc.sarima.HC2)
plot(sarima.HC2)
# HoltWinters
hw.HC2 <- forecast(HoltWinters(HC2.train.ts, seasonal = "additive"), h = 28)
hw.HC2$mean
hw.HC2.df <- data.frame(hw.HC2)
rownames(hw.HC2.df) <- date_decimal(as.numeric(rownames(hw.HC2.df)))
acc.hw.HC2 <- accuracy(hw.HC2, HC2.valid.ts)
knitr::kable(acc.hw.HC2)
plot(hw.HC2)


# State Space (Tbats)
tbats.HC2 <- forecast(tbats(HC2.train.ts), h = 28)
tbats.HC2$mean
tbats.HC2.df <- data.frame(tbats.HC2)
rownames(tbats.HC2.df) <- date_decimal(as.numeric(rownames(tbats.HC2.df)))
acc.tbats.HC2 <- accuracy(tbats.HC2, HC2.valid.ts)
knitr::kable(acc.tbats.HC2)
plot(tbats.HC2)
```

```{r}
library(lubridate)
library(forecast)
library(ggplot2)
Projectdata

# Forecasting Hobbies 
# create a time series for the HC3 data
HC3 <- ts(Projectdata$Hobbies_CA_3, start= c(2011,01, 29), frequency = 365)

time = time(HC3)

# validation set is 10% of the data set
n.valid <- 197
n.train <- length(HC3) - n.valid

HC3.train.ts <- window(HC2, start=time[1], end=time[n.train])
HC3.valid.ts <- window(HC3, start=time[n.train+1], end=time[n.train+n.valid])


# Naive Hobbies 
naive.HC3 = naive(HC3.train.ts, h= 28)
naive.HC3$mean
naive.HC3_df = data.frame(naive.HC3)
rownames(naive.HC3_df) = date_decimal(as.numeric(rownames(naive.HC3_df)))
acc.naive.HC3 <- accuracy(naive.HC3, HC3.valid.ts)
knitr::kable(acc.naive.HC3)

# Seasonal Naive Hobbies 
snaive.HC3 = snaive(HC3.train.ts, h =28)
snaive.HC3$mean
snaive.HC3_df = data.frame(snaive.HC3)
rownames(snaive.HC3_df) = date_decimal(as.numeric(rownames(snaive.HC3_df)))
acc.snaive.HC3 <- accuracy(snaive.HC3, HC3.valid.ts)
knitr::kable(acc.snaive.HC3)

# Exponential Smoothing 
es.HC3 = ses(HC3.train.ts, h = 28)
es.HC3$mean
es.HC3_df <- data.frame(es.HC3)
rownames(es.HC3_df) <- date_decimal(as.numeric(rownames(es.HC3_df)))
acc.es.HC3 <- accuracy(es.HC3, HC3.valid.ts)
knitr::kable(acc.es.HC3)

# Moving Average
ma.HC3 <- forecast(ma(HC3.train.ts, order = 5), h = 28)
ma.HC3$mean
ma.HC3_df <- data.frame(ma.HC3)
rownames(ma.HC3_df) <- date_decimal(as.numeric(rownames(ma.HC3_df)))
acc.ma.HC3 <- accuracy(ma.HC3, HC3.valid.ts)
knitr::kable(acc.ma.HC3)

# SARIMA
sarima.HC3 <- forecast(auto.arima(HC3.train.ts, D = 1), h = 28)
sarima.HC3$mean
sarima.HC3_df <- data.frame(sarima.HC3)
rownames(sarima.HC3_df) <- date_decimal(as.numeric(rownames(sarima.HC3_df)))
acc.sarima.HC3 <- accuracy(sarima.HC3, HC3.valid.ts)
knitr::kable(acc.sarima.HC3)
plot(sarima.HC3)

# HoltWinters
hw.HC3 <- forecast(HoltWinters(HC3.train.ts, seasonal = "additive"), h = 28)
hw.HC3$mean
hw.HC3.df <- data.frame(hw.HC3)
rownames(hw.HC3.df) <- date_decimal(as.numeric(rownames(hw.HC3.df)))
acc.hw.HC3 <- accuracy(hw.HC3, HC3.valid.ts)
knitr::kable(acc.hw.HC3)
plot(hw.HC3)

# State Space (Tbats)
tbats.HC3 <- forecast(tbats(HC3.train.ts), h = 28)
tbats.HC3$mean
tbats.HC3.df <- data.frame(tbats.HC3)
rownames(tbats.HC3.df) <- date_decimal(as.numeric(rownames(tbats.HC3.df)))
acc.tbats.HC3 <- accuracy(tbats.HC3, HC3.valid.ts)
knitr::kable(acc.tbats.HC3)
plot(tbats.HC3)
```



```{r}
# Forecasting foods_1 CA_1
# create a time series for the F1C1 data
F1C1 <- ts(Projectdata$Foods_1_CA_1, start= c(2011,01, 29), frequency = 365)

time = time(F1C1)

# validation set is 10% of the data set
n.valid <- 197
n.train <- length(F1C1) - n.valid

F1C1.train.ts <- window(F1C1, start=time[1], end=time[n.train])
F1C1.valid.ts <- window(F1C1, start=time[n.train+1], end=time[n.train+n.valid])


# Naive Hobbies 
naive.F1C1 = naive(F1C1.train.ts, h= 28)
naive.F1C1$mean
naive.F1C1_df = data.frame(naive.F1C1)
rownames(naive.F1C1_df) = date_decimal(as.numeric(rownames(naive.F1C1_df)))
acc.naive.F1C1 <- accuracy(naive.F1C1, F1C1.valid.ts)
knitr::kable(acc.naive.F1C1)

# Seasonal Naive Hobbies 
snaive.F1C1 = snaive(F1C1.train.ts, h =28)
snaive.F1C1$mean
snaive.F1C1_df = data.frame(snaive.F1C1)
rownames(snaive.F1C1_df) = date_decimal(as.numeric(rownames(snaive.F1C1_df)))
acc.snaive.F1C1 <- accuracy(snaive.F1C1, F1C1.valid.ts)
knitr::kable(acc.snaive.F1C1)

# Exponential Smoothing 
es.F1C1 = ses(F1C1.train.ts, h = 28)
es.F1C1$mean
es.F1C1_df <- data.frame(es.F1C1)
rownames(es.F1C1_df) <- date_decimal(as.numeric(rownames(es.F1C1_df)))
acc.es.F1C1 <- accuracy(es.F1C1, F1C1.valid.ts)
knitr::kable(acc.es.F1C1)

# Moving Average
ma.F1C1 <- forecast(ma(F1C1.train.ts, order = 5), h = 28)
ma.F1C1$mean
ma.F1C1_df <- data.frame(ma.F1C1)
rownames(ma.F1C1_df) <- date_decimal(as.numeric(rownames(ma.F1C1_df)))
acc.ma.F1C1 <- accuracy(ma.F1C1, F1C1.valid.ts)
knitr::kable(acc.ma.F1C1)

# SARIMA
sarima.F1C1 <- forecast(auto.arima(F1C1.train.ts, D = 1), h = 28)
sarima.F1C1$mean
sarima.F1C1_df <- data.frame(sarima.F1C1)
rownames(sarima.F1C1_df) <- date_decimal(as.numeric(rownames(sarima.F1C1_df)))
acc.sarima.F1C1 <- accuracy(sarima.F1C1, F1C1.valid.ts)
knitr::kable(acc.sarima.F1C1)
plot(sarima.F1C1)
# HoltWinters
hw.F1C1 <- forecast(HoltWinters(F1C1.train.ts, seasonal = "additive"), h = 28)
hw.F1C1$mean
hw.F1C1.df <- data.frame(hw.F1C1)
rownames(hw.F1C1.df) <- date_decimal(as.numeric(rownames(hw.F1C1.df)))
acc.hw.F1C1 <- accuracy(hw.F1C1, F1C1.valid.ts)
knitr::kable(acc.hw.F1C1)
plot(hw.F1C1)

# State Space (Tbats)
tbats.F1C1 <- forecast(tbats(F1C1.train.ts), h = 28)
tbats.F1C1$mean
tbats.F1C1.df <- data.frame(tbats.F1C1)
rownames(tbats.F1C1.df) <- date_decimal(as.numeric(rownames(tbats.F1C1.df)))
acc.tbats.F1C1 <- accuracy(tbats.F1C1, F1C1.valid.ts)
knitr::kable(acc.tbats.F1C1)
plot(tbats.F1C1)


```



```{r}
# Forecasting foods_1 CA_2
# create a time series for the F1C2 data
F1C2 <- ts(Projectdata$Foods_1_CA_2, start= c(2011,01, 29), frequency = 365)

time = time(F1C2)

# validation set is 10% of the data set
n.valid <- 197
n.train <- length(F1C2) - n.valid

F1C2.train.ts <- window(F1C2, start=time[1], end=time[n.train])
F1C2.valid.ts <- window(F1C2, start=time[n.train+1], end=time[n.train+n.valid])


# Naive Hobbies 
naive.F1C2 = naive(F1C2.train.ts, h= 28)
naive.F1C2$mean
naive.F1C2_df = data.frame(naive.F1C2)
rownames(naive.F1C2_df) = date_decimal(as.numeric(rownames(naive.F1C2_df)))
acc.naive.F1C2 <- accuracy(naive.F1C2, F1C2.valid.ts)
knitr::kable(acc.naive.F1C2)

# Seasonal Naive Hobbies 
snaive.F1C2 = snaive(F1C2.train.ts, h =28)
snaive.F1C2$mean
snaive.F1C2_df = data.frame(snaive.F1C2)
rownames(snaive.F1C2_df) = date_decimal(as.numeric(rownames(snaive.F1C2_df)))
acc.snaive.F1C2 <- accuracy(snaive.F1C2, F1C2.valid.ts)
knitr::kable(acc.snaive.F1C2)

# Exponential Smoothing 
es.F1C2 = ses(F1C2.train.ts, h = 28)
es.F1C2$mean
es.F1C2_df <- data.frame(es.F1C2)
rownames(es.F1C2_df) <- date_decimal(as.numeric(rownames(es.F1C2_df)))
acc.es.F1C2 <- accuracy(es.F1C2, F1C2.valid.ts)
knitr::kable(acc.es.F1C2)

# Moving Average
ma.F1C2 <- forecast(ma(F1C2.train.ts, order = 5), h = 28)
ma.F1C2$mean
ma.F1C2_df <- data.frame(ma.F1C2)
rownames(ma.F1C2_df) <- date_decimal(as.numeric(rownames(ma.F1C2_df)))
acc.ma.F1C2 <- accuracy(ma.F1C2, F1C2.valid.ts)
knitr::kable(acc.ma.F1C2)

# SARIMA
sarima.F1C2 <- forecast(auto.arima(F1C2.train.ts, D = 1), h = 28)
sarima.F1C2$mean
sarima.F1C2_df <- data.frame(sarima.F1C2)
rownames(sarima.F1C2_df) <- date_decimal(as.numeric(rownames(sarima.F1C2_df)))
acc.sarima.F1C2 <- accuracy(sarima.F1C2, F1C2.valid.ts)
knitr::kable(acc.sarima.F1C2)
plot(sarima.F1C2)
# HoltWinters
hw.F1C2 <- forecast(HoltWinters(F1C2.train.ts, seasonal = "additive"), h = 28)
hw.F1C2$mean
hw.F1C2.df <- data.frame(hw.F1C2)
rownames(hw.F1C2.df) <- date_decimal(as.numeric(rownames(hw.F1C2.df)))
acc.hw.F1C2 <- accuracy(hw.F1C2, F1C2.valid.ts)
knitr::kable(acc.hw.F1C2)
plot(hw.F1C2)

# State Space (Tbats)
tbats.F1C2 <- forecast(tbats(F1C2.train.ts), h = 28)
tbats.F1C2$mean
tbats.F1C2.df <- data.frame(tbats.F1C2)
rownames(tbats.F1C2.df) <- date_decimal(as.numeric(rownames(tbats.F1C2.df)))
acc.tbats.F1C2 <- accuracy(tbats.F1C2, F1C2.valid.ts)
knitr::kable(acc.tbats.F1C2)
plot(tbats.F1C2)

```



```{r}
# Forecasting foods_1 CA_3
# create a time series for the F1C3 data
F1C3 <- ts(Projectdata$Foods_1_CA_3, start= c(2011,01, 29), frequency = 365)

time = time(F1C3)

# validation set is 10% of the data set
n.valid <- 197
n.train <- length(F1C3) - n.valid

F1C3.train.ts <- window(F1C3, start=time[1], end=time[n.train])
F1C3.valid.ts <- window(F1C3, start=time[n.train+1], end=time[n.train+n.valid])


# Naive Hobbies 
naive.F1C3 = naive(F1C3.train.ts, h= 28)
naive.F1C3$mean
naive.F1C3_df = data.frame(naive.F1C3)
rownames(naive.F1C3_df) = date_decimal(as.numeric(rownames(naive.F1C3_df)))
acc.naive.F1C3 <- accuracy(naive.F1C3, F1C3.valid.ts)
knitr::kable(acc.naive.F1C3)

# Seasonal Naive Hobbies 
snaive.F1C3 = snaive(F1C3.train.ts, h =28)
snaive.F1C3$mean
snaive.F1C3_df = data.frame(snaive.F1C3)
rownames(snaive.F1C3_df) = date_decimal(as.numeric(rownames(snaive.F1C3_df)))
acc.snaive.F1C3 <- accuracy(snaive.F1C3, F1C3.valid.ts)
knitr::kable(acc.snaive.F1C3)

# Exponential Smoothing 
es.F1C3 = ses(F1C3.train.ts, h = 28)
es.F1C3$mean
es.F1C3_df <- data.frame(es.F1C3)
rownames(es.F1C3_df) <- date_decimal(as.numeric(rownames(es.F1C3_df)))
acc.es.F1C3 <- accuracy(es.F1C3, F1C3.valid.ts)
knitr::kable(acc.es.F1C3)

# Moving Average
ma.F1C3 <- forecast(ma(F1C3.train.ts, order = 5), h = 28)
ma.F1C3$mean
ma.F1C3_df <- data.frame(ma.F1C3)
rownames(ma.F1C3_df) <- date_decimal(as.numeric(rownames(ma.F1C3_df)))
acc.ma.F1C3 <- accuracy(ma.F1C3, F1C3.valid.ts)
knitr::kable(acc.ma.F1C3)

# SARIMA
sarima.F1C3 <- forecast(auto.arima(F1C3.train.ts, D = 1), h = 28)
sarima.F1C3$mean
sarima.F1C3_df <- data.frame(sarima.F1C3)
rownames(sarima.F1C3_df) <- date_decimal(as.numeric(rownames(sarima.F1C3_df)))
acc.sarima.F1C3 <- accuracy(sarima.F1C3, F1C3.valid.ts)
knitr::kable(acc.sarima.F1C3)
plot(sarima.F1C3)

# HoltWinters
hw.F1C3 <- forecast(HoltWinters(F1C3.train.ts, seasonal = "additive"), h = 28)
hw.F1C3$mean
hw.F1C3.df <- data.frame(hw.F1C3)
rownames(hw.F1C3.df) <- date_decimal(as.numeric(rownames(hw.F1C3.df)))
acc.hw.F1C3 <- accuracy(hw.F1C3, F1C3.valid.ts)
knitr::kable(acc.hw.F1C3)
plot(hw.F1C3)

# State Space (Tbats)
tbats.F1C3 <- forecast(tbats(F1C3.train.ts), h = 28)
tbats.F1C3$mean
tbats.F1C3.df <- data.frame(tbats.F1C3)
rownames(tbats.F1C3.df) <- date_decimal(as.numeric(rownames(tbats.F1C3.df)))
acc.tbats.F1C3 <- accuracy(tbats.F1C3, F1C3.valid.ts)
knitr::kable(acc.tbats.F1C3)
plot(tbats.F1C3)
```



```{r}

# Forecasting foods_2 CA_1
# create a time series for the Food2 C1 data
F2C1 <- ts(Projectdata$Foods_2_CA_1, start= c(2011,01, 29), frequency = 365)

time = time(F2C1)

# validation set is 10% of the data set
n.valid <- 197
n.train <- length(F2C1) - n.valid

F2C1.train.ts <- window(F2C1, start=time[1], end=time[n.train])
F2C1.valid.ts <- window(F2C1, start=time[n.train+1], end=time[n.train+n.valid])


# Naive Hobbies 
naive.F2C1 = naive(F2C1.train.ts, h= 28)
naive.F2C1$mean
naive.F2C1_df = data.frame(naive.F2C1)
rownames(naive.F2C1_df) = date_decimal(as.numeric(rownames(naive.F2C1_df)))
acc.naive.F2C1 <- accuracy(naive.F2C1, F2C1.valid.ts)
knitr::kable(acc.naive.F2C1)

# Seasonal Naive Hobbies 
snaive.F2C1 = snaive(F2C1.train.ts, h =28)
snaive.F2C1$mean
snaive.F2C1_df = data.frame(snaive.F2C1)
rownames(snaive.F2C1_df) = date_decimal(as.numeric(rownames(snaive.F2C1_df)))
acc.snaive.F2C1 <- accuracy(snaive.F2C1, F2C1.valid.ts)
knitr::kable(acc.snaive.F2C1)

# Exponential Smoothing 
es.F2C1 = ses(F2C1.train.ts, h = 28)
es.F2C1$mean
es.F2C1_df <- data.frame(es.F2C1)
rownames(es.F2C1_df) <- date_decimal(as.numeric(rownames(es.F2C1_df)))
acc.es.F2C1 <- accuracy(es.F2C1, F2C1.valid.ts)
knitr::kable(acc.es.F2C1)

# Moving Average
ma.F2C1 <- forecast(ma(F2C1.train.ts, order = 5), h = 28)
ma.F2C1$mean
ma.F2C1_df <- data.frame(ma.F2C1)
rownames(ma.F2C1_df) <- date_decimal(as.numeric(rownames(ma.F2C1_df)))
acc.ma.F2C1 <- accuracy(ma.F2C1, F2C1.valid.ts)
knitr::kable(acc.ma.F2C1)

# SARIMA
sarima.F2C1 <- forecast(auto.arima(F2C1.train.ts, D = 1), h = 28)
sarima.F2C1$mean
sarima.F2C1_df <- data.frame(sarima.F2C1)
rownames(sarima.F2C1_df) <- date_decimal(as.numeric(rownames(sarima.F2C1_df)))
acc.sarima.F2C1 <- accuracy(sarima.F2C1, F2C1.valid.ts)
knitr::kable(acc.sarima.F2C1)
plot(sarima.F2C1)

# HoltWinters
hw.F2C1 <- forecast(HoltWinters(F2C1.train.ts, seasonal = "additive"), h = 28)
hw.F2C1$mean
hw.F2C1.df <- data.frame(hw.F2C1)
rownames(hw.F2C1.df) <- date_decimal(as.numeric(rownames(hw.F2C1.df)))
acc.hw.F2C1 <- accuracy(hw.F2C1, F2C1.valid.ts)
knitr::kable(acc.hw.F2C1)
plot(hw.F2C1)

# State Space (Tbats)
tbats.F2C1 <- forecast(tbats(F2C1.train.ts), h = 28)
tbats.F2C1$mean
tbats.F2C1.df <- data.frame(tbats.F2C1)
rownames(tbats.F2C1.df) <- date_decimal(as.numeric(rownames(tbats.F2C1.df)))
acc.tbats.F2C1 <- accuracy(tbats.F2C1, F2C1.valid.ts)
knitr::kable(acc.tbats.F2C1)
plot(tbats.F2C1)


```

```{r}
# Forecasting foods_2 CA_2
# create a time series for the Food2 CA2 data
F2C2 <- ts(Projectdata$Foods_2_CA_2, start= c(2011,01, 29), frequency = 365)

time = time(F2C2)

# validation set is 10% of the data set
n.valid <- 197
n.train <- length(F2C2) - n.valid

F2C2.train.ts <- window(F2C2, start=time[1], end=time[n.train])
F2C2.valid.ts <- window(F2C2, start=time[n.train+1], end=time[n.train+n.valid])


# Naive Hobbies 
naive.F2C2 = naive(F2C2.train.ts, h= 28)
naive.F2C2$mean
naive.F2C2_df = data.frame(naive.F2C2)
rownames(naive.F2C2_df) = date_decimal(as.numeric(rownames(naive.F2C2_df)))
acc.naive.F2C2 <- accuracy(naive.F2C2, F2C2.valid.ts)
knitr::kable(acc.naive.F2C2)

# Seasonal Naive Hobbies 
snaive.F2C2 = snaive(F2C2.train.ts, h =28)
snaive.F2C2$mean
snaive.F2C2_df = data.frame(snaive.F2C2)
rownames(snaive.F2C2_df) = date_decimal(as.numeric(rownames(snaive.F2C2_df)))
acc.snaive.F2C2 <- accuracy(snaive.F2C2, F2C2.valid.ts)
knitr::kable(acc.snaive.F2C2)

# Exponential Smoothing 
es.F2C2 = ses(F2C2.train.ts, h = 28)
es.F2C2$mean
es.F2C2_df <- data.frame(es.F2C2)
rownames(es.F2C2_df) <- date_decimal(as.numeric(rownames(es.F2C2_df)))
acc.es.F2C2 <- accuracy(es.F2C2, F2C2.valid.ts)
knitr::kable(acc.es.F2C2)

# Moving Average
ma.F2C2 <- forecast(ma(F2C2.train.ts, order = 5), h = 28)
ma.F2C2$mean
ma.F2C2_df <- data.frame(ma.F2C2)
rownames(ma.F2C2_df) <- date_decimal(as.numeric(rownames(ma.F2C2_df)))
acc.ma.F2C2 <- accuracy(ma.F2C2, F2C2.valid.ts)
knitr::kable(acc.ma.F2C2)

# SARIMA
sarima.F2C2 <- forecast(auto.arima(F2C2.train.ts, D = 1), h = 28)
sarima.F2C2$mean
sarima.F2C2_df <- data.frame(sarima.F2C2)
rownames(sarima.F2C2_df) <- date_decimal(as.numeric(rownames(sarima.F2C2_df)))
acc.sarima.F2C2 <- accuracy(sarima.F2C2, F2C2.valid.ts)
knitr::kable(acc.sarima.F2C2)
plot(sarima.F2C2)

# HoltWinters
hw.F2C2 <- forecast(HoltWinters(F2C2.train.ts, seasonal = "additive"), h = 28)
hw.F2C2$mean
hw.F2C2.df <- data.frame(hw.F2C2)
rownames(hw.F2C2.df) <- date_decimal(as.numeric(rownames(hw.F2C2.df)))
acc.hw.F2C2 <- accuracy(hw.F2C2, F2C2.valid.ts)
knitr::kable(acc.hw.F2C2)
plot(hw.F2C2)


# State Space (Tbats)
tbats.F2C2 <- forecast(tbats(F2C2.train.ts), h = 28)
tbats.F2C2$mean
tbats.F2C2.df <- data.frame(tbats.F2C2)
rownames(tbats.F2C2.df) <- date_decimal(as.numeric(rownames(tbats.F2C2.df)))
acc.tbats.F2C2 <- accuracy(tbats.F2C2, F2C2.valid.ts)
knitr::kable(acc.tbats.F2C2)
plot(tbats.F2C2)
```

```{r}
# Forecasting foods_2 CA_3
# create a time series for the F2C3 data
F2C3 <- ts(Projectdata$Foods_2_CA_3, start= c(2011,01, 29), frequency = 365)

time = time(F2C3)

# validation set is 10% of the data set
n.valid <- 197
n.train <- length(F2C3) - n.valid

F2C3.train.ts <- window(F2C3, start=time[1], end=time[n.train])
F2C3.valid.ts <- window(F2C3, start=time[n.train+1], end=time[n.train+n.valid])


# Naive Hobbies 
naive.F2C3 = naive(F2C3.train.ts, h= 28)
naive.F2C3$mean
naive.F2C3_df = data.frame(naive.F2C3)
rownames(naive.F2C3_df) = date_decimal(as.numeric(rownames(naive.F2C3_df)))
acc.naive.F2C3 <- accuracy(naive.F2C3, F2C3.valid.ts)
knitr::kable(acc.naive.F2C3)

# Seasonal Naive Hobbies 
snaive.F2C3 = snaive(F2C3.train.ts, h =28)
snaive.F2C3$mean
snaive.F2C3_df = data.frame(snaive.F2C3)
rownames(snaive.F2C3_df) = date_decimal(as.numeric(rownames(snaive.F2C3_df)))
acc.snaive.F2C3 <- accuracy(snaive.F2C3, F2C3.valid.ts)
knitr::kable(acc.snaive.F2C3)

# Exponential Smoothing 
es.F2C3 = ses(F2C3.train.ts, h = 28)
es.F2C3$mean
es.F2C3_df <- data.frame(es.F2C3)
rownames(es.F2C3_df) <- date_decimal(as.numeric(rownames(es.F2C3_df)))
acc.es.F2C3 <- accuracy(es.F2C3, F2C3.valid.ts)
knitr::kable(acc.es.F2C3)

# Moving Average
ma.F2C3 <- forecast(ma(F2C3.train.ts, order = 5), h = 28)
ma.F2C3$mean
ma.F2C3_df <- data.frame(ma.F2C3)
rownames(ma.F2C3_df) <- date_decimal(as.numeric(rownames(ma.F2C3_df)))
acc.ma.F2C3 <- accuracy(ma.F2C3, F2C3.valid.ts)
knitr::kable(acc.ma.F2C3)

# SARIMA
sarima.F2C3 <- forecast(auto.arima(F2C3.train.ts, D = 1), h = 28)
sarima.F2C3$mean
sarima.F2C3_df <- data.frame(sarima.F2C3)
rownames(sarima.F2C3_df) <- date_decimal(as.numeric(rownames(sarima.F2C3_df)))
acc.sarima.F2C3 <- accuracy(sarima.F2C3, F2C3.valid.ts)
knitr::kable(acc.sarima.F2C3)
plot(sarima.F2C3)

# HoltWinters
hw.F2C3 <- forecast(HoltWinters(F2C3.train.ts, seasonal = "additive"), h = 28)
hw.F2C3$mean
hw.F2C3.df <- data.frame(hw.F2C3)
rownames(hw.F2C3.df) <- date_decimal(as.numeric(rownames(hw.F2C3.df)))
acc.hw.F2C3 <- accuracy(hw.F2C3, F2C3.valid.ts)
knitr::kable(acc.hw.F2C3)
plot(hw.F2C3)

# State Space (Tbats)
tbats.F2C3 <- forecast(tbats(F2C3.train.ts), h = 28)
tbats.F2C3$mean
tbats.F2C3.df <- data.frame(tbats.F2C3)
rownames(tbats.F2C3.df) <- date_decimal(as.numeric(rownames(tbats.F2C3.df)))
acc.tbats.F2C3 <- accuracy(tbats.F2C3, F2C3.valid.ts)
knitr::kable(acc.tbats.F2C3)
plot(tbats.F2C3)

```

```{r}

# Forecasting Food3 CA_1
# create a time series for the F3C1 data
F3C1 <- ts(Projectdata$Foods_3_CA_1, start= c(2011,01, 29), frequency = 365)

time = time(F3C1)

# validation set is 10% of the data set
n.valid <- 197
n.train <- length(F3C1) - n.valid

F3C1.train.ts <- window(F3C1, start=time[1], end=time[n.train])
F3C1.valid.ts <- window(F3C1, start=time[n.train+1], end=time[n.train+n.valid])


# Naive Hobbies 
naive.F3C1 = naive(F3C1.train.ts, h= 28)
naive.F3C1$mean
naive.F3C1_df = data.frame(naive.F3C1)
rownames(naive.F3C1_df) = date_decimal(as.numeric(rownames(naive.F3C1_df)))
acc.naive.F3C1 <- accuracy(naive.F3C1, F3C1.valid.ts)
knitr::kable(acc.naive.F3C1)

# Seasonal Naive Hobbies 
snaive.F3C1 = snaive(F3C1.train.ts, h =28)
snaive.F3C1$mean
snaive.F3C1_df = data.frame(snaive.F3C1)
rownames(snaive.F3C1_df) = date_decimal(as.numeric(rownames(snaive.F3C1_df)))
acc.snaive.F3C1 <- accuracy(snaive.F3C1, F3C1.valid.ts)
knitr::kable(acc.snaive.F3C1)

# Exponential Smoothing 
es.F3C1 = ses(F3C1.train.ts, h = 28)
es.F3C1$mean
es.F3C1_df <- data.frame(es.F3C1)
rownames(es.F3C1_df) <- date_decimal(as.numeric(rownames(es.F3C1_df)))
acc.es.F3C1 <- accuracy(es.F3C1, F3C1.valid.ts)
knitr::kable(acc.es.F3C1)

# Moving Average
ma.F3C1 <- forecast(ma(F3C1.train.ts, order = 5), h = 28)
ma.F3C1$mean
ma.F3C1_df <- data.frame(ma.F3C1)
rownames(ma.F3C1_df) <- date_decimal(as.numeric(rownames(ma.F3C1_df)))
acc.ma.F3C1 <- accuracy(ma.F3C1, F3C1.valid.ts)
knitr::kable(acc.ma.F3C1)

# SARIMA
sarima.F3C1 <- forecast(auto.arima(F3C1.train.ts, D = 1), h = 28)
sarima.F3C1$mean
sarima.F3C1_df <- data.frame(sarima.F3C1)
rownames(sarima.F3C1_df) <- date_decimal(as.numeric(rownames(sarima.F3C1_df)))
acc.sarima.F3C1 <- accuracy(sarima.F3C1, F3C1.valid.ts)
knitr::kable(acc.sarima.F3C1)
plot(sarima.F3C1)

# HoltWinters
hw.F3C1 <- forecast(HoltWinters(F3C1.train.ts, seasonal = "additive"), h = 28)
hw.F3C1$mean
hw.F3C1.df <- data.frame(hw.F3C1)
rownames(hw.F3C1.df) <- date_decimal(as.numeric(rownames(hw.F3C1.df)))
acc.hw.F3C1 <- accuracy(hw.F3C1, F3C1.valid.ts)
knitr::kable(acc.hw.F3C1)
plot(hw.F3C1)

# State Space (Tbats)
tbats.F3C1 <- forecast(tbats(F3C1.train.ts), h = 28)
tbats.F3C1$mean
tbats.F3C1.df <- data.frame(tbats.F3C1)
rownames(tbats.F3C1.df) <- date_decimal(as.numeric(rownames(tbats.F3C1.df)))
acc.tbats.F3C1 <- accuracy(tbats.F3C1, F3C1.valid.ts)
knitr::kable(acc.tbats.F3C1)
plot(tbats.F3C1)

```



```{r}


# Forecasting Food3 CA_2
# create a time series for the F3C2 data
F3C2 <- ts(Projectdata$Foods_3_CA_2, start= c(2011,01, 29), frequency = 365)

time = time(F3C2)

# validation set is 10% of the data set
n.valid <- 197
n.train <- length(F3C2) - n.valid

F3C2.train.ts <- window(F3C2, start=time[1], end=time[n.train])
F3C2.valid.ts <- window(F3C2, start=time[n.train+1], end=time[n.train+n.valid])


# Naive Hobbies 
naive.F3C2 = naive(F3C2.train.ts, h= 28)
naive.F3C2$mean
naive.F3C2_df = data.frame(naive.F3C2)
rownames(naive.F3C2_df) = date_decimal(as.numeric(rownames(naive.F3C2_df)))
acc.naive.F3C2 <- accuracy(naive.F3C2, F3C2.valid.ts)
knitr::kable(acc.naive.F3C2)

# Seasonal Naive Hobbies 
snaive.F3C2 = snaive(F3C2.train.ts, h =28)
snaive.F3C2$mean
snaive.F3C2_df = data.frame(snaive.F3C2)
rownames(snaive.F3C2_df) = date_decimal(as.numeric(rownames(snaive.F3C2_df)))
acc.snaive.F3C2 <- accuracy(snaive.F3C2, F3C2.valid.ts)
knitr::kable(acc.snaive.F3C2)

# Exponential Smoothing 
es.F3C2 = ses(F3C2.train.ts, h = 28)
es.F3C2$mean
es.F3C2_df <- data.frame(es.F3C2)
rownames(es.F3C2_df) <- date_decimal(as.numeric(rownames(es.F3C2_df)))
acc.es.F3C2 <- accuracy(es.F3C2, F3C2.valid.ts)
knitr::kable(acc.es.F3C2)

# Moving Average
ma.F3C2 <- forecast(ma(F3C2.train.ts, order = 5), h = 28)
ma.F3C2$mean
ma.F3C2_df <- data.frame(ma.F3C2)
rownames(ma.F3C2_df) <- date_decimal(as.numeric(rownames(ma.F3C2_df)))
acc.ma.F3C2 <- accuracy(ma.F3C2, F3C2.valid.ts)
knitr::kable(acc.ma.F3C2)

# SARIMA
sarima.F3C2 <- forecast(auto.arima(F3C2.train.ts, D = 1), h = 28)
sarima.F3C2$mean
sarima.F3C2_df <- data.frame(sarima.F3C2)
rownames(sarima.F3C2_df) <- date_decimal(as.numeric(rownames(sarima.F3C2_df)))
acc.sarima.F3C2 <- accuracy(sarima.F3C2, F3C2.valid.ts)
knitr::kable(acc.sarima.F3C2)
plot(sarima.F3C2)

# HoltWinters
hw.F3C2 <- forecast(HoltWinters(F3C2.train.ts, seasonal = "additive"), h = 28)
hw.F3C2$mean
hw.F3C2.df <- data.frame(hw.F3C2)
rownames(hw.F3C2.df) <- date_decimal(as.numeric(rownames(hw.F3C2.df)))
acc.hw.F3C2 <- accuracy(hw.F3C2, F3C2.valid.ts)
knitr::kable(acc.hw.F3C2)
plot(hw.F3C2)

# State Space (Tbats)
tbats.F3C2 <- forecast(tbats(F3C2.train.ts), h = 28)
tbats.F3C2$mean
tbats.F3C2.df <- data.frame(tbats.F3C2)
rownames(tbats.F3C2.df) <- date_decimal(as.numeric(rownames(tbats.F3C2.df)))
acc.tbats.F3C2 <- accuracy(tbats.F3C2, F3C2.valid.ts)
knitr::kable(acc.tbats.F3C2)
plot(tbats.F3C2)


```


```{r}

# Forecasting Food3 CA_3
# create a time series for the F3C3 data
F3C3 <- ts(Projectdata$Foods_3_CA_3, start= c(2011,01, 29), frequency = 365)

time = time(F3C3)

# validation set is 10% of the data set
n.valid <- 197
n.train <- length(F3C3) - n.valid

F3C3.train.ts <- window(F3C3, start=time[1], end=time[n.train])
F3C3.valid.ts <- window(F3C3, start=time[n.train+1], end=time[n.train+n.valid])


# Naive Hobbies 
naive.F3C3 = naive(F3C3.train.ts, h= 28)
naive.F3C3$mean
naive.F3C3_df = data.frame(naive.F3C3)
rownames(naive.F3C3_df) = date_decimal(as.numeric(rownames(naive.F3C3_df)))
acc.naive.F3C3 <- accuracy(naive.F3C3, F3C3.valid.ts)
knitr::kable(acc.naive.F3C3)

# Seasonal Naive Hobbies 
snaive.F3C3 = snaive(F3C3.train.ts, h =28)
snaive.F3C3$mean
snaive.F3C3_df = data.frame(snaive.F3C3)
rownames(snaive.F3C3_df) = date_decimal(as.numeric(rownames(snaive.F3C3_df)))
acc.snaive.F3C3 <- accuracy(snaive.F3C3, F3C3.valid.ts)
knitr::kable(acc.snaive.F3C3)

# Exponential Smoothing 
es.F3C3 = ses(F3C3.train.ts, h = 28)
es.F3C3$mean
es.F3C3_df <- data.frame(es.F3C3)
rownames(es.F3C3_df) <- date_decimal(as.numeric(rownames(es.F3C3_df)))
acc.es.F3C3 <- accuracy(es.F3C3, F3C3.valid.ts)
knitr::kable(acc.es.F3C3)

# Moving Average
ma.F3C3 <- forecast(ma(F3C3.train.ts, order = 5), h = 28)
ma.F3C3$mean
ma.F3C3_df <- data.frame(ma.F3C3)
rownames(ma.F3C3_df) <- date_decimal(as.numeric(rownames(ma.F3C3_df)))
acc.ma.F3C3 <- accuracy(ma.F3C3, F3C3.valid.ts)
knitr::kable(acc.ma.F3C3)

# SARIMA
sarima.F3C3 <- forecast(auto.arima(F3C3.train.ts, D = 1), h = 28)
sarima.F3C3$mean
sarima.F3C3_df <- data.frame(sarima.F3C3)
rownames(sarima.F3C3_df) <- date_decimal(as.numeric(rownames(sarima.F3C3_df)))
acc.sarima.F3C3 <- accuracy(sarima.F3C3, F3C3.valid.ts)
knitr::kable(acc.sarima.F3C3)
plot(sarima.F3C3)

# HoltWinters
hw.F3C3 <- forecast(HoltWinters(F3C3.train.ts, seasonal = "additive"), h = 28)
hw.F3C3$mean
hw.F3C3.df <- data.frame(hw.F3C3)
rownames(hw.F3C3.df) <- date_decimal(as.numeric(rownames(hw.F3C3.df)))
acc.hw.F3C3 <- accuracy(hw.F3C3, F3C3.valid.ts)
knitr::kable(acc.hw.F3C3)
plot(hw.F3C3)


# State Space (Tbats)
tbats.F3C3 <- forecast(tbats(F3C3.train.ts), h = 28)
tbats.F3C3$mean
tbats.F3C3.df <- data.frame(tbats.F3C3)
rownames(tbats.F3C3.df) <- date_decimal(as.numeric(rownames(tbats.F3C3.df)))
acc.tbats.F3C3 <- accuracy(tbats.F3C3, F3C3.valid.ts)
knitr::kable(acc.tbats.F3C3)
plot(tbats.F3C3)


```



```{r}
# Forecasting HouseHold1 CA_1
# create a time series for the data
HH1C1 <- ts(Projectdata$Household_1_CA_1, start= c(2011,01, 29), frequency = 365)

time = time(HH1C1)

# validation set is 10% of the data set
n.valid <- 197
n.train <- length(HH1C1) - n.valid

HH1C1.train.ts <- window(HH1C1, start=time[1], end=time[n.train])
HH1C1.valid.ts <- window(HH1C1, start=time[n.train+1], end=time[n.train+n.valid])


# Naive Hobbies 
naive.HH1C1 = naive(HH1C1.train.ts, h= 28)
naive.HH1C1$mean
naive.HH1C1_df = data.frame(naive.HH1C1)
rownames(naive.HH1C1_df) = date_decimal(as.numeric(rownames(naive.HH1C1_df)))
acc.naive.HH1C1 <- accuracy(naive.HH1C1, HH1C1.valid.ts)
knitr::kable(acc.naive.HH1C1)

# Seasonal Naive Hobbies 
snaive.HH1C1 = snaive(HH1C1.train.ts, h =28)
snaive.HH1C1$mean
snaive.HH1C1_df = data.frame(snaive.HH1C1)
rownames(snaive.HH1C1_df) = date_decimal(as.numeric(rownames(snaive.HH1C1_df)))
acc.snaive.HH1C1 <- accuracy(snaive.HH1C1, HH1C1.valid.ts)
knitr::kable(acc.snaive.HH1C1)

# Exponential Smoothing 
es.HH1C1 = ses(HH1C1.train.ts, h = 28)
es.HH1C1$mean
es.HH1C1_df <- data.frame(es.HH1C1)
rownames(es.HH1C1_df) <- date_decimal(as.numeric(rownames(es.HH1C1_df)))
acc.es.HH1C1 <- accuracy(es.HH1C1, HH1C1.valid.ts)
knitr::kable(acc.es.HH1C1)

# Moving Average
ma.HH1C1 <- forecast(ma(HH1C1.train.ts, order = 5), h = 28)
ma.HH1C1$mean
ma.HH1C1_df <- data.frame(ma.HH1C1)
rownames(ma.HH1C1_df) <- date_decimal(as.numeric(rownames(ma.HH1C1_df)))
acc.ma.HH1C1 <- accuracy(ma.HH1C1, HH1C1.valid.ts)
knitr::kable(acc.ma.HH1C1)

# SARIMA
sarima.HH1C1 <- forecast(auto.arima(HH1C1.train.ts, D = 1), h = 28)
sarima.HH1C1$mean
sarima.HH1C1_df <- data.frame(sarima.HH1C1)
rownames(sarima.HH1C1_df) <- date_decimal(as.numeric(rownames(sarima.HH1C1_df)))
acc.sarima.HH1C1 <- accuracy(sarima.HH1C1, HH1C1.valid.ts)
knitr::kable(acc.sarima.HH1C1)
plot(sarima.HH1C1)

# HoltWinters
hw.HH1C1 <- forecast(HoltWinters(HH1C1.train.ts, seasonal = "additive"), h = 28)
hw.HH1C1$mean
hw.HH1C1.df <- data.frame(hw.HH1C1)
rownames(hw.HH1C1.df) <- date_decimal(as.numeric(rownames(hw.HH1C1.df)))
acc.hw.HH1C1 <- accuracy(hw.HH1C1, HH1C1.valid.ts)
knitr::kable(acc.hw.HH1C1)
plot(hw.HH1C1)

# State Space (Tbats)
tbats.HH1C1 <- forecast(tbats(HH1C1.train.ts), h = 28)
tbats.HH1C1$mean
tbats.HH1C1.df <- data.frame(tbats.HH1C1)
rownames(tbats.HH1C1.df) <- date_decimal(as.numeric(rownames(tbats.HH1C1.df)))
acc.tbats.HH1C1 <- accuracy(tbats.HH1C1, HH1C1.valid.ts)
knitr::kable(acc.tbats.HH1C1)
plot(tbats.HH1C1)

```

```{r}
# Forecasting HouseHold1 CA_2
# create a time series for the HH1C2 data
HH1C2 <- ts(Projectdata$Household_1_CA_2, start= c(2011,01, 29), frequency = 365)

time = time(HH1C2)

# validation set is 10% of the data set
n.valid <- 197
n.train <- length(HH1C2) - n.valid

HH1C2.train.ts <- window(HH1C2, start=time[1], end=time[n.train])
HH1C2.valid.ts <- window(HH1C2, start=time[n.train+1], end=time[n.train+n.valid])


# Naive Hobbies 
naive.HH1C2 = naive(HH1C2.train.ts, h= 28)
naive.HH1C2$mean
naive.HH1C2_df = data.frame(naive.HH1C2)
rownames(naive.HH1C2_df) = date_decimal(as.numeric(rownames(naive.HH1C2_df)))
acc.naive.HH1C2 <- accuracy(naive.HH1C2, HH1C2.valid.ts)
knitr::kable(acc.naive.HH1C2)

# Seasonal Naive Hobbies 
snaive.HH1C2 = snaive(HH1C2.train.ts, h =28)
snaive.HH1C2$mean
snaive.HH1C2_df = data.frame(snaive.HH1C2)
rownames(snaive.HH1C2_df) = date_decimal(as.numeric(rownames(snaive.HH1C2_df)))
acc.snaive.HH1C2 <- accuracy(snaive.HH1C2, HH1C2.valid.ts)
knitr::kable(acc.snaive.HH1C2)

# Exponential Smoothing 
es.HH1C2 = ses(HH1C2.train.ts, h = 28)
es.HH1C2$mean
es.HH1C2_df <- data.frame(es.HH1C2)
rownames(es.HH1C2_df) <- date_decimal(as.numeric(rownames(es.HH1C2_df)))
acc.es.HH1C2 <- accuracy(es.HH1C2, HH1C2.valid.ts)
knitr::kable(acc.es.HH1C2)

# Moving Average
ma.HH1C2 <- forecast(ma(HH1C2.train.ts, order = 5), h = 28)
ma.HH1C2$mean
ma.HH1C2_df <- data.frame(ma.HH1C2)
rownames(ma.HH1C2_df) <- date_decimal(as.numeric(rownames(ma.HH1C2_df)))
acc.ma.HH1C2 <- accuracy(ma.HH1C2, HH1C2.valid.ts)
knitr::kable(acc.ma.HH1C2)

# SARIMA
sarima.HH1C2 <- forecast(auto.arima(HH1C2.train.ts, D = 1), h = 28)
sarima.HH1C2$mean
sarima.HH1C2_df <- data.frame(sarima.HH1C2)
rownames(sarima.HH1C2_df) <- date_decimal(as.numeric(rownames(sarima.HH1C2_df)))
acc.sarima.HH1C2 <- accuracy(sarima.HH1C2, HH1C2.valid.ts)
knitr::kable(acc.sarima.HH1C2)
plot(sarima.HH1C2)

# HoltWinters
hw.HH1C2 <- forecast(HoltWinters(HH1C2.train.ts, seasonal = "additive"), h = 28)
hw.HH1C2$mean
hw.HH1C2.df <- data.frame(hw.HH1C2)
rownames(hw.HH1C2.df) <- date_decimal(as.numeric(rownames(hw.HH1C2.df)))
acc.hw.HH1C2 <- accuracy(hw.HH1C2, HH1C2.valid.ts)
knitr::kable(acc.hw.HH1C2)
plot(hw.HH1C2)


# State Space (Tbats)
tbats.HH1C2 <- forecast(tbats(HH1C2.train.ts), h = 28)
tbats.HH1C2$mean
tbats.HH1C2.df <- data.frame(tbats.HH1C2)
rownames(tbats.HH1C2.df) <- date_decimal(as.numeric(rownames(tbats.HH1C2.df)))
acc.tbats.HH1C2 <- accuracy(tbats.HH1C2, HH1C2.valid.ts)
knitr::kable(acc.tbats.HH1C2)
plot(tbats.HH1C2)
```

```{r}

# Forecasting HouseHold1 CA_3
# create a time series for the HH1C3 ata
HH1C3 <- ts(Projectdata$Household_1_CA_3, start= c(2011,01, 29), frequency = 365)

time = time(HH1C3)

# validation set is 10% of the data set
n.valid <- 197
n.train <- length(HH1C3) - n.valid

HH1C3.train.ts <- window(HH1C3, start=time[1], end=time[n.train])
HH1C3.valid.ts <- window(HH1C3, start=time[n.train+1], end=time[n.train+n.valid])


# Naive Hobbies 
naive.HH1C3 = naive(HH1C3.train.ts, h= 28)
naive.HH1C3$mean
naive.HH1C3_df = data.frame(naive.HH1C3)
rownames(naive.HH1C3_df) = date_decimal(as.numeric(rownames(naive.HH1C3_df)))
acc.naive.HH1C3 <- accuracy(naive.HH1C3, HH1C3.valid.ts)
knitr::kable(acc.naive.HH1C3)

# Seasonal Naive Hobbies 
snaive.HH1C3 = snaive(HH1C3.train.ts, h =28)
snaive.HH1C3$mean
snaive.HH1C3_df = data.frame(snaive.HH1C3)
rownames(snaive.HH1C3_df) = date_decimal(as.numeric(rownames(snaive.HH1C3_df)))
acc.snaive.HH1C3 <- accuracy(snaive.HH1C3, HH1C3.valid.ts)
knitr::kable(acc.snaive.HH1C3)

# Exponential Smoothing 
es.HH1C3 = ses(HH1C3.train.ts, h = 28)
es.HH1C3$mean
es.HH1C3_df <- data.frame(es.HH1C3)
rownames(es.HH1C3_df) <- date_decimal(as.numeric(rownames(es.HH1C3_df)))
acc.es.HH1C3 <- accuracy(es.HH1C3, HH1C3.valid.ts)
knitr::kable(acc.es.HH1C3)

# Moving Average
ma.HH1C3 <- forecast(ma(HH1C3.train.ts, order = 5), h = 28)
ma.HH1C3$mean
ma.HH1C3_df <- data.frame(ma.HH1C3)
rownames(ma.HH1C3_df) <- date_decimal(as.numeric(rownames(ma.HH1C3_df)))
acc.ma.HH1C3 <- accuracy(ma.HH1C3, HH1C3.valid.ts)
knitr::kable(acc.ma.HH1C3)

# SARIMA
sarima.HH1C3 <- forecast(auto.arima(HH1C3.train.ts, D = 1), h = 28)
sarima.HH1C3$mean
sarima.HH1C3_df <- data.frame(sarima.HH1C3)
rownames(sarima.HH1C3_df) <- date_decimal(as.numeric(rownames(sarima.HH1C3_df)))
acc.sarima.HH1C3 <- accuracy(sarima.HH1C3, HH1C3.valid.ts)
knitr::kable(acc.sarima.HH1C3)
plot(sarima.HH1C3)

# HoltWinters
hw.HH1C3 <- forecast(HoltWinters(HH1C3.train.ts, seasonal = "additive"), h = 28)
hw.HH1C3$mean
hw.HH1C3.df <- data.frame(hw.HH1C3)
rownames(hw.HH1C3.df) <- date_decimal(as.numeric(rownames(hw.HH1C3.df)))
acc.hw.HH1C3 <- accuracy(hw.HH1C3, HH1C3.valid.ts)
knitr::kable(acc.hw.HH1C3)
plot(hw.HH1C3)


# State Space (Tbats)
tbats.HH1C3 <- forecast(tbats(HH1C3.train.ts), h = 28)
tbats.HH1C3$mean
tbats.HH1C3.df <- data.frame(tbats.HH1C3)
rownames(tbats.HH1C3.df) <- date_decimal(as.numeric(rownames(tbats.HH1C3.df)))
acc.tbats.HH1C3 <- accuracy(tbats.HH1C3, HH1C3.valid.ts)
knitr::kable(acc.tbats.HH1C3)
plot(tbats.HH1C3)
```

```{r}

# Forecasting HouseHold2 CA_1
# create a time series for the HH2C1 ata
HH2C1 <- ts(Projectdata$Household_2_CA_1, start= c(2011,01, 29), frequency = 365)

time = time(HH2C1)

# validation set is 10% of the data set
n.valid <- 197
n.train <- length(HH2C1) - n.valid

HH2C1.train.ts <- window(HH2C1, start=time[1], end=time[n.train])
HH2C1.valid.ts <- window(HH2C1, start=time[n.train+1], end=time[n.train+n.valid])


# Naive Hobbies 
naive.HH2C1 = naive(HH2C1.train.ts, h= 28)
naive.HH2C1$mean
naive.HH2C1_df = data.frame(naive.HH2C1)
rownames(naive.HH2C1_df) = date_decimal(as.numeric(rownames(naive.HH2C1_df)))
acc.naive.HH2C1 <- accuracy(naive.HH2C1, HH2C1.valid.ts)
knitr::kable(acc.naive.HH2C1)

# Seasonal Naive Hobbies 
snaive.HH2C1 = snaive(HH2C1.train.ts, h =28)
snaive.HH2C1$mean
snaive.HH2C1_df = data.frame(snaive.HH2C1)
rownames(snaive.HH2C1_df) = date_decimal(as.numeric(rownames(snaive.HH2C1_df)))
acc.snaive.HH2C1 <- accuracy(snaive.HH2C1, HH2C1.valid.ts)
knitr::kable(acc.snaive.HH2C1)

# Exponential Smoothing 
es.HH2C1 = ses(HH2C1.train.ts, h = 28)
es.HH2C1$mean
es.HH2C1_df <- data.frame(es.HH2C1)
rownames(es.HH2C1_df) <- date_decimal(as.numeric(rownames(es.HH2C1_df)))
acc.es.HH2C1 <- accuracy(es.HH2C1, HH2C1.valid.ts)
knitr::kable(acc.es.HH2C1)

# Moving Average
ma.HH2C1 <- forecast(ma(HH2C1.train.ts, order = 5), h = 28)
ma.HH2C1$mean
ma.HH2C1_df <- data.frame(ma.HH2C1)
rownames(ma.HH2C1_df) <- date_decimal(as.numeric(rownames(ma.HH2C1_df)))
acc.ma.HH2C1 <- accuracy(ma.HH2C1, HH2C1.valid.ts)
knitr::kable(acc.ma.HH2C1)

# SARIMA
sarima.HH2C1 <- forecast(auto.arima(HH2C1.train.ts, D = 1), h = 28)
sarima.HH2C1$mean
sarima.HH2C1_df <- data.frame(sarima.HH2C1)
rownames(sarima.HH2C1_df) <- date_decimal(as.numeric(rownames(sarima.HH2C1_df)))
acc.sarima.HH2C1 <- accuracy(sarima.HH2C1, HH2C1.valid.ts)
knitr::kable(acc.sarima.HH2C1)
plot(sarima.HH2C1)

# HoltWinters
hw.HH2C1 <- forecast(HoltWinters(HH2C1.train.ts, seasonal = "additive"), h = 28)
hw.HH2C1$mean
hw.HH2C1.df <- data.frame(hw.HH2C1)
rownames(hw.HH2C1.df) <- date_decimal(as.numeric(rownames(hw.HH2C1.df)))
acc.hw.HH2C1 <- accuracy(hw.HH2C1, HH2C1.valid.ts)
knitr::kable(acc.hw.HH2C1)
plot(hw.HH2C1)



# State Space (Tbats)
tbats.HH2C1 <- forecast(tbats(HH2C1.train.ts), h = 28)
tbats.HH2C1$mean
tbats.HH2C1.df <- data.frame(tbats.HH2C1)
rownames(tbats.HH2C1.df) <- date_decimal(as.numeric(rownames(tbats.HH2C1.df)))
acc.tbats.HH2C1 <- accuracy(tbats.HH2C1, HH2C1.valid.ts)
knitr::kable(acc.tbats.HH2C1)
plot(tbats.HH2C1)

```

```{r}

# Forecasting HouseHold2 CA_2
# create a time series for the HH2C2 data
HH2C2 <- ts(Projectdata$Household_2_CA_2, start= c(2011,01, 29), frequency = 365)

time = time(HH2C2)

# validation set is 10% of the data set
n.valid <- 197
n.train <- length(HH2C2) - n.valid

HH2C2.train.ts <- window(HH2C2, start=time[1], end=time[n.train])
HH2C2.valid.ts <- window(HH2C2, start=time[n.train+1], end=time[n.train+n.valid])


# Naive Hobbies 
naive.HH2C2 = naive(HH2C2.train.ts, h= 28)
naive.HH2C2$mean
naive.HH2C2_df = data.frame(naive.HH2C2)
rownames(naive.HH2C2_df) = date_decimal(as.numeric(rownames(naive.HH2C2_df)))
acc.naive.HH2C2 <- accuracy(naive.HH2C2, HH2C2.valid.ts)
knitr::kable(acc.naive.HH2C2)

# Seasonal Naive Hobbies 
snaive.HH2C2 = snaive(HH2C2.train.ts, h =28)
snaive.HH2C2$mean
snaive.HH2C2_df = data.frame(snaive.HH2C2)
rownames(snaive.HH2C2_df) = date_decimal(as.numeric(rownames(snaive.HH2C2_df)))
acc.snaive.HH2C2 <- accuracy(snaive.HH2C2, HH2C2.valid.ts)
knitr::kable(acc.snaive.HH2C2)

# Exponential Smoothing 
es.HH2C2 = ses(HH2C2.train.ts, h = 28)
es.HH2C2$mean
es.HH2C2_df <- data.frame(es.HH2C2)
rownames(es.HH2C2_df) <- date_decimal(as.numeric(rownames(es.HH2C2_df)))
acc.es.HH2C2 <- accuracy(es.HH2C2, HH2C2.valid.ts)
knitr::kable(acc.es.HH2C2)

# Moving Average
ma.HH2C2 <- forecast(ma(HH2C2.train.ts, order = 5), h = 28)
ma.HH2C2$mean
ma.HH2C2_df <- data.frame(ma.HH2C2)
rownames(ma.HH2C2_df) <- date_decimal(as.numeric(rownames(ma.HH2C2_df)))
acc.ma.HH2C2 <- accuracy(ma.HH2C2, HH2C2.valid.ts)
knitr::kable(acc.ma.HH2C2)

# SARIMA
sarima.HH2C2 <- forecast(auto.arima(HH2C2.train.ts, D = 1), h = 28)
sarima.HH2C2$mean
sarima.HH2C2_df <- data.frame(sarima.HH2C2)
rownames(sarima.HH2C2_df) <- date_decimal(as.numeric(rownames(sarima.HH2C2_df)))
acc.sarima.HH2C2 <- accuracy(sarima.HH2C2, HH2C2.valid.ts)
knitr::kable(acc.sarima.HH2C2)
plot(sarima.HH2C2)

# HoltWinters
hw.HH2C2 <- forecast(HoltWinters(HH2C2.train.ts, seasonal = "additive"), h = 28)
hw.HH2C2$mean
hw.HH2C2.df <- data.frame(hw.HH2C2)
rownames(hw.HH2C2.df) <- date_decimal(as.numeric(rownames(hw.HH2C2.df)))
acc.hw.HH2C2 <- accuracy(hw.HH2C2, HH2C2.valid.ts)
knitr::kable(acc.hw.HH2C2)
plot(hw.HH2C2)


# State Space (Tbats)
tbats.HH2C2 <- forecast(tbats(HH2C2.train.ts), h = 28)
tbats.HH2C2$mean
tbats.HH2C2.df <- data.frame(tbats.HH2C2)
rownames(tbats.HH2C2.df) <- date_decimal(as.numeric(rownames(tbats.HH2C2.df)))
acc.tbats.HH2C2 <- accuracy(tbats.HH2C2, HH2C2.valid.ts)
knitr::kable(acc.tbats.HH2C2)
plot(tbats.HH2C2)

```

```{r}
# Forecasting HouseHold2 CA_3
# create a time series for the HH2C3 data
HH2C3 <- ts(Projectdata$Household_2_CA_3, start= c(2011,01, 29), frequency = 365)

time = time(HH2C3)

# validation set is 10% of the data set
n.valid <- 197
n.train <- length(HH2C3) - n.valid

HH2C3.train.ts <- window(HH2C3, start=time[1], end=time[n.train])
HH2C3.valid.ts <- window(HH2C3, start=time[n.train+1], end=time[n.train+n.valid])


# Naive Hobbies 
naive.HH2C3 = naive(HH2C3.train.ts, h= 28)
naive.HH2C3$mean
naive.HH2C3_df = data.frame(naive.HH2C3)
rownames(naive.HH2C3_df) = date_decimal(as.numeric(rownames(naive.HH2C3_df)))
acc.naive.HH2C3 <- accuracy(naive.HH2C3, HH2C3.valid.ts)
knitr::kable(acc.naive.HH2C3)

# Seasonal Naive Hobbies 
snaive.HH2C3 = snaive(HH2C3.train.ts, h =28)
snaive.HH2C3$mean
snaive.HH2C3_df = data.frame(snaive.HH2C3)
rownames(snaive.HH2C3_df) = date_decimal(as.numeric(rownames(snaive.HH2C3_df)))
acc.snaive.HH2C3 <- accuracy(snaive.HH2C3, HH2C3.valid.ts)
knitr::kable(acc.snaive.HH2C3)

# Exponential Smoothing 
es.HH2C3 = ses(HH2C3.train.ts, h = 28)
es.HH2C3$mean
es.HH2C3_df <- data.frame(es.HH2C3)
rownames(es.HH2C3_df) <- date_decimal(as.numeric(rownames(es.HH2C3_df)))
acc.es.HH2C3 <- accuracy(es.HH2C3, HH2C3.valid.ts)
knitr::kable(acc.es.HH2C3)

# Moving Average
ma.HH2C3 <- forecast(ma(HH2C3.train.ts, order = 5), h = 28)
ma.HH2C3$mean
ma.HH2C3_df <- data.frame(ma.HH2C3)
rownames(ma.HH2C3_df) <- date_decimal(as.numeric(rownames(ma.HH2C3_df)))
acc.ma.HH2C3 <- accuracy(ma.HH2C3, HH2C3.valid.ts)
knitr::kable(acc.ma.HH2C3)

# SARIMA
sarima.HH2C3 <- forecast(auto.arima(HH2C3.train.ts, D = 1), h = 28)
sarima.HH2C3$mean
sarima.HH2C3_df <- data.frame(sarima.HH2C3)
rownames(sarima.HH2C3_df) <- date_decimal(as.numeric(rownames(sarima.HH2C3_df)))
acc.sarima.HH2C3 <- accuracy(sarima.HH2C3, HH2C3.valid.ts)
knitr::kable(acc.sarima.HH2C3)
plot(sarima.HH2C3)

# HoltWinters
hw.HH2C3 <- forecast(HoltWinters(HH2C3.train.ts, seasonal = "additive"), h = 28)
hw.HH2C3$mean
hw.HH2C3.df <- data.frame(hw.HH2C3)
rownames(hw.HH2C3.df) <- date_decimal(as.numeric(rownames(hw.HH2C3.df)))
acc.hw.HH2C3 <- accuracy(hw.HH2C3, HH2C3.valid.ts)
knitr::kable(acc.hw.HH2C3)
plot(hw.HH2C3)


# State Space (Tbats)
tbats.HH2C3 <- forecast(tbats(HH2C3.train.ts), h = 28)
tbats.HH2C3$mean
tbats.HH2C3.df <- data.frame(tbats.HH2C3)
rownames(tbats.HH2C3.df) <- date_decimal(as.numeric(rownames(tbats.HH2C3.df)))
acc.tbats.HH2C3 <- accuracy(tbats.HH2C3, HH2C3.valid.ts)
knitr::kable(acc.tbats.HH2C3)
plot(tbats.HH2C3)
```


```{r}
# This code is for question 4
# we decided to aggregate data based on the store level
Projectdata

# California1 Store Sales
CA1 <- Projectdata$Hobbies_CA_1 + Projectdata$Household_1_CA_1 + Projectdata$Household_2_CA_1 + Projectdata$Foods_1_CA_1 + Projectdata$Foods_2_CA_1 + Projectdata$Foods_2_CA_1 + Projectdata$Foods_3_CA_1

# California2 Store Sales
CA2 <- Projectdata$Hobbies_CA_2 + Projectdata$Household_1_CA_2 + Projectdata$Household_2_CA_1 + Projectdata$Foods_1_CA_2 + Projectdata$Foods_2_CA_2 + Projectdata$Foods_2_CA_2 + Projectdata$Foods_3_CA_2

# California3 Store Sales
CA3 <- Projectdata$Hobbies_CA_3 + Projectdata$Household_1_CA_3 + Projectdata$Household_2_CA_3 + Projectdata$Foods_1_CA_3 + Projectdata$Foods_2_CA_3 + Projectdata$Foods_2_CA_3 + Projectdata$Foods_3_CA_3

# Create a new data frame with aggregate stores sales
stores_data <- data.frame(date = Projectdata$date)
stores_data$CA1 = CA1
stores_data$CA2 = CA2
stores_data$CA3 = CA3



```
```{r}
# Forecasting Based on aggregated store data

# create a time series for the CA1 data

CA1 <- ts(stores_data$CA1, start= c(2011,01, 29), frequency = 365)

time = time(CA1)

# validation set is 10% of the data set
n.valid <- 197
n.train <- length(CA1) - n.valid

CA1.train.ts <- window(CA1, start=time[1], end=time[n.train])
CA1.valid.ts <- window(CA1, start=time[n.train+1], end=time[n.train+n.valid])


# Naive Hobbies 
naive.CA1 = naive(CA1.train.ts, h= 28)
naive.CA1$mean
naive.CA1_df = data.frame(naive.CA1)
rownames(naive.CA1_df) = date_decimal(as.numeric(rownames(naive.CA1_df)))
acc.naive.CA1 <- accuracy(naive.CA1, CA1.valid.ts)
knitr::kable(acc.naive.CA1)
plot(naive.CA1)

# Seasonal Naive Hobbies 
snaive.CA1 = snaive(CA1.train.ts, h =28)
snaive.CA1$mean
snaive.CA1_df = data.frame(snaive.CA1)
rownames(snaive.CA1_df) = date_decimal(as.numeric(rownames(snaive.CA1_df)))
acc.snaive.CA1 <- accuracy(snaive.CA1, CA1.valid.ts)
knitr::kable(acc.snaive.CA1)
plot(snaive.CA1)

# Exponential Smoothing 
es.CA1 = ses(CA1.train.ts, h = 28)
es.CA1$mean
es.CA1_df <- data.frame(es.CA1)
rownames(es.CA1_df) <- date_decimal(as.numeric(rownames(es.CA1_df)))
acc.es.CA1 <- accuracy(es.CA1, CA1.valid.ts)
knitr::kable(acc.es.CA1)
plot(es.CA1)

# Moving Average
ma.CA1 <- forecast(ma(CA1.train.ts, order = 5), h = 28)
ma.CA1$mean
ma.CA1_df <- data.frame(ma.CA1)
rownames(ma.CA1_df) <- date_decimal(as.numeric(rownames(ma.CA1_df)))
acc.ma.CA1 <- accuracy(ma.CA1, CA1.valid.ts)
knitr::kable(acc.ma.CA1)
plot(ma.CA1)

# SARIMA
sarima.CA1 <- forecast(auto.arima(CA1.train.ts, D = 1), h = 28)
sarima.CA1$mean
sarima.CA1_df <- data.frame(sarima.CA1)
rownames(sarima.CA1_df) <- date_decimal(as.numeric(rownames(sarima.CA1_df)))
acc.sarima.CA1 <- accuracy(sarima.CA1, CA1.valid.ts)
knitr::kable(acc.sarima.CA1)
plot(sarima.CA1)

# HoltWinters
hw.CA1 <- forecast(HoltWinters(CA1.train.ts, seasonal = "additive"), h = 28)
hw.CA1$mean
hw.CA1.df <- data.frame(hw.CA1)
rownames(hw.CA1.df) <- date_decimal(as.numeric(rownames(hw.CA1.df)))
acc.hw.CA1 <- accuracy(hw.CA1, CA1.valid.ts)
knitr::kable(acc.hw.CA1)
plot(hw.CA1)


# State Space (Tbats)
tbats.CA1 <- forecast(tbats(CA1.train.ts), h = 28)
tbats.CA1$mean
tbats.CA1.df <- data.frame(tbats.CA1)
rownames(tbats.CA1.df) <- date_decimal(as.numeric(rownames(tbats.CA1.df)))
acc.tbats.CA1 <- accuracy(tbats.CA1, CA1.valid.ts)
knitr::kable(acc.tbats.CA1)
plot(tbats.CA1)
```

```{r}

# Forecasting Based on aggregated store data


# create a time series for the CA2 data
CA2 <- ts(stores_data$CA2, start= c(2011,01, 29), frequency = 365)

time = time(CA2)

# validation set is 10% of the data set
n.valid <- 197
n.train <- length(CA2) - n.valid

CA2.train.ts <- window(CA2, start=time[1], end=time[n.train])
CA2.valid.ts <- window(CA2, start=time[n.train+1], end=time[n.train+n.valid])


# Naive Hobbies 
naive.CA2 = naive(CA2.train.ts, h= 28)
naive.CA2$mean
naive.CA2_df = data.frame(naive.CA2)
rownames(naive.CA2_df) = date_decimal(as.numeric(rownames(naive.CA2_df)))
acc.naive.CA2 <- accuracy(naive.CA2, CA2.valid.ts)
knitr::kable(acc.naive.CA2)
plot(naive.CA2)

# Seasonal Naive Hobbies 
snaive.CA2 = snaive(CA2.train.ts, h =28)
snaive.CA2$mean
snaive.CA2_df = data.frame(snaive.CA2)
rownames(snaive.CA2_df) = date_decimal(as.numeric(rownames(snaive.CA2_df)))
acc.snaive.CA2 <- accuracy(snaive.CA2, CA2.valid.ts)
knitr::kable(acc.snaive.CA2)
plot(snaive.CA2)

# Exponential Smoothing 
es.CA2 = ses(CA2.train.ts, h = 28)
es.CA2$mean
es.CA2_df <- data.frame(es.CA2)
rownames(es.CA2_df) <- date_decimal(as.numeric(rownames(es.CA2_df)))
acc.es.CA2 <- accuracy(es.CA2, CA2.valid.ts)
knitr::kable(acc.es.CA2)
plot(es.CA2)

# Moving Average
ma.CA2 <- forecast(ma(CA2.train.ts, order = 5), h = 28)
ma.CA2$mean
ma.CA2_df <- data.frame(ma.CA2)
rownames(ma.CA2_df) <- date_decimal(as.numeric(rownames(ma.CA2_df)))
acc.ma.CA2 <- accuracy(ma.CA2, CA2.valid.ts)
knitr::kable(acc.ma.CA2)
plot(ma.CA2)

# SARIMA
sarima.CA2 <- forecast(auto.arima(CA2.train.ts, D = 1), h = 28)
sarima.CA2$mean
sarima.CA2_df <- data.frame(sarima.CA2)
rownames(sarima.CA2_df) <- date_decimal(as.numeric(rownames(sarima.CA2_df)))
acc.sarima.CA2 <- accuracy(sarima.CA2, CA2.valid.ts)
knitr::kable(acc.sarima.CA2)
plot(sarima.CA2)

# HoltWinters
hw.CA2 <- forecast(HoltWinters(CA2.train.ts, seasonal = "additive"), h = 28)
hw.CA2$mean
hw.CA2.df <- data.frame(hw.CA2)
rownames(hw.CA2.df) <- date_decimal(as.numeric(rownames(hw.CA2.df)))
acc.hw.CA2 <- accuracy(hw.CA2, CA2.valid.ts)
knitr::kable(acc.hw.CA2)
plot(hw.CA2)


# State Space (Tbats)
tbats.CA2 <- forecast(tbats(CA2.train.ts), h = 28)
tbats.CA2$mean
tbats.CA2.df <- data.frame(tbats.CA2)
rownames(tbats.CA2.df) <- date_decimal(as.numeric(rownames(tbats.CA2.df)))
acc.tbats.CA2 <- accuracy(tbats.CA2, CA2.valid.ts)
knitr::kable(acc.tbats.CA2)
plot(tbats.CA2)
```


```{r}

# create a time series for the CA3 data

CA3 <- ts(stores_data$CA3, start= c(2011,01, 29), frequency = 365)

time = time(CA3)

# validation set is 10% of the data set
n.valid <- 197
n.train <- length(CA3) - n.valid

CA3.train.ts <- window(CA3, start=time[1], end=time[n.train])
CA3.valid.ts <- window(CA3, start=time[n.train+1], end=time[n.train+n.valid])


# Naive Hobbies 
naive.CA3 = naive(CA3.train.ts, h= 28)
naive.CA3$mean
naive.CA3_df = data.frame(naive.CA3)
rownames(naive.CA3_df) = date_decimal(as.numeric(rownames(naive.CA3_df)))
acc.naive.CA3 <- accuracy(naive.CA3, CA3.valid.ts)
knitr::kable(acc.naive.CA3)
plot(naive.CA3)

# Seasonal Naive Hobbies 
snaive.CA3 = snaive(CA3.train.ts, h =28)
snaive.CA3$mean
snaive.CA3_df = data.frame(snaive.CA3)
rownames(snaive.CA3_df) = date_decimal(as.numeric(rownames(snaive.CA3_df)))
acc.snaive.CA3 <- accuracy(snaive.CA3, CA3.valid.ts)
knitr::kable(acc.snaive.CA3)
plot(snaive.CA3)

# Exponential Smoothing 
es.CA3 = ses(CA3.train.ts, h = 28)
es.CA3$mean
es.CA3_df <- data.frame(es.CA3)
rownames(es.CA3_df) <- date_decimal(as.numeric(rownames(es.CA3_df)))
acc.es.CA3 <- accuracy(es.CA3, CA3.valid.ts)
knitr::kable(acc.es.CA3)
plot(es.CA3)

# Moving Average
ma.CA3 <- forecast(ma(CA3.train.ts, order = 5), h = 28)
ma.CA3$mean
ma.CA3_df <- data.frame(ma.CA3)
rownames(ma.CA3_df) <- date_decimal(as.numeric(rownames(ma.CA3_df)))
acc.ma.CA3 <- accuracy(ma.CA3, CA3.valid.ts)
knitr::kable(acc.ma.CA3)
plot(ma.CA3)

# SARIMA
sarima.CA3 <- forecast(auto.arima(CA3.train.ts, D = 1), h = 28)
sarima.CA3$mean
sarima.CA3_df <- data.frame(sarima.CA3)
rownames(sarima.CA3_df) <- date_decimal(as.numeric(rownames(sarima.CA3_df)))
acc.sarima.CA3 <- accuracy(sarima.CA3, CA3.valid.ts)
knitr::kable(acc.sarima.CA3)
plot(sarima.CA3)

# HoltWinters
hw.CA3 <- forecast(HoltWinters(CA3.train.ts, seasonal = "additive"), h = 28)
hw.CA3$mean
hw.CA3.df <- data.frame(hw.CA3)
rownames(hw.CA3.df) <- date_decimal(as.numeric(rownames(hw.CA3.df)))
acc.hw.CA3 <- accuracy(hw.CA3, CA3.valid.ts)
knitr::kable(acc.hw.CA3)
plot(hw.CA3)



# State Space (Tbats)
tbats.CA3 <- forecast(tbats(CA3.train.ts), h = 28)
tbats.CA3$mean
tbats.CA3.df <- data.frame(tbats.CA3)
rownames(tbats.CA3.df) <- date_decimal(as.numeric(rownames(tbats.CA3.df)))
acc.tbats.CA3 <- accuracy(tbats.CA3, CA3.valid.ts)
knitr::kable(acc.tbats.CA3)
plot(tbats.CA3)
```


```{r}
library(xts)
# Code for quesiton 5
# Convert data from daily to weekly

wd_HC1 <- apply.weekly(as.xts(Projectdata$Hobbies_CA_1, order.by= Projectdata$date), sum)
wd_HC2 <- apply.weekly(as.xts(Projectdata$Hobbies_CA_2, order.by = Projectdata$date), sum)
wd_HC3 <- apply.weekly(as.xts(Projectdata$Hobbies_CA_3, order.by = Projectdata$date), sum)
wd_F1C1 <- apply.weekly(as.xts(Projectdata$Foods_1_CA_1, order.by = Projectdata$date), sum)
wd_F1C2 <- apply.weekly(as.xts(Projectdata$Foods_1_CA_2, order.by = Projectdata$date), sum)
wd_F1C3 <- apply.weekly(as.xts(Projectdata$Foods_1_CA_3, order.by = Projectdata$date), sum)
wd_F2C1 <- apply.weekly(as.xts(Projectdata$Foods_2_CA_1, order.by = Projectdata$date), sum)
wd_F2C2 <- apply.weekly(as.xts(Projectdata$Foods_2_CA_2, order.by = Projectdata$date), sum)
wd_F2C3 <- apply.weekly(as.xts(Projectdata$Foods_2_CA_3, order.by = Projectdata$date), sum)
wd_F3C1 <- apply.weekly(as.xts(Projectdata$Foods_3_CA_1, order.by = Projectdata$date), sum)
wd_F3C2 <- apply.weekly(as.xts(Projectdata$Foods_3_CA_2, order.by = Projectdata$date), sum)
wd_F3C3 <- apply.weekly(as.xts(Projectdata$Foods_3_CA_3, order.by = Projectdata$date), sum)
wd_HH1C1 <- apply.weekly(as.xts(Projectdata$Household_1_CA_1, order.by = Projectdata$date), sum)
wd_HH1C2 <- apply.weekly(as.xts(Projectdata$Household_1_CA_2, order.by = Projectdata$date), sum)
wd_HH1C3 <- apply.weekly(as.xts(Projectdata$Household_1_CA_3, order.by = Projectdata$date), sum)
wd_HH2C1 <- apply.weekly(as.xts(Projectdata$Household_2_CA_1, order.by = Projectdata$date), sum)
wd_HH2C2 <- apply.weekly(as.xts(Projectdata$Household_2_CA_2, order.by = Projectdata$date), sum)
wd_HH2C3 <- apply.weekly(as.xts(Projectdata$Household_2_CA_3, order.by = Projectdata$date), sum)

weekly_df <- data.frame(wd_HC1)
weekly_df$wd_HC2 <- wd_HC2
weekly_df$wd_HC3 <- wd_HC3
weekly_df$wd_F1C1 <- wd_F1C1
weekly_df$wd_F1C2 <- wd_F1C2
weekly_df$wd_F1C3 <- wd_F1C3
weekly_df$wd_F2C1 <- wd_F2C1
weekly_df$wd_F2C2 <- wd_F2C2
weekly_df$wd_F2C3 <- wd_F2C3
weekly_df$wd_F3C1 <- wd_F3C1
weekly_df$wd_F3C2 <- wd_F3C2
weekly_df$wd_F3C3 <- wd_F3C3
weekly_df$wd_HH1C1 <- wd_HH1C1
weekly_df$wd_HH1C2 <- wd_HH1C2
weekly_df$wd_HH1C3 <- wd_HH1C3
weekly_df$wd_HH2C1 <- wd_HH2C1
weekly_df$wd_HH2C2 <- wd_HH2C2
weekly_df$wd_HH2C3 <- wd_HH2C3

```

```{r}
library(forecast)
library(lubridate)

# create a time series for the Hobbies CA1  data
weekly_df$date <- as.Date(rownames(weekly_df))
rownames(weekly_df) <- NULL
weekly_df
HC1_w <- ts(weekly_df$wd_HC1, start= c(2011,01, 29), frequency = 52)
HC1_w
time = time(HC1_w)
time
# validation set is 10% of the data set
n.valid <- 28
n.train <- length(HC1_w) - n.valid

HC1_w.train.ts <- window(HC1_w, start=time[1], end=time[n.train])
HC1_w.valid.ts <- window(HC1_w, start=time[n.train+1], end=time[n.train+n.valid])
HC1_w.train.ts
?window()
# Naive Hobbies 
naive.CA1 = naive(HC1_w.train.ts, h= 28)
naive.CA1$mean
naive.CA1_df = data.frame(naive.CA1)
rownames(naive.CA1_df) = date_decimal(as.numeric(rownames(naive.CA1_df)))
acc.naive.CA1 <- accuracy(naive.CA1, HC1_w.valid.ts)
knitr::kable(acc.naive.CA1)
plot(naive.CA1)

# Seasonal Naive Hobbies 
snaive.CA1 = snaive(HC1_w.train.ts, h= 28)
snaive.CA1$mean
snaive.CA1_df = data.frame(snaive.CA1)
snaive.CA1_df
rownames(snaive.CA1_df) = date_decimal(as.numeric(rownames(snaive.CA1_df)))
snaive.CA1_df
acc.snaive.CA1 <- accuracy(snaive.CA1, HC1_w.valid.ts)
knitr::kable(acc.snaive.CA1)
plot(snaive.CA1)

# Exponential Smoothing 
es.CA1 = ses(HC1_w.train.ts, h = 28)
es.CA1$mean
es.CA1_df <- data.frame(es.CA1)
rownames(es.CA1_df) <- date_decimal(as.numeric(rownames(es.CA1_df)))
acc.es.CA1 <- accuracy(es.CA1, HC1_w.valid.ts)
knitr::kable(acc.es.CA1)
plot(es.CA1)

# Moving Average
ma.CA1 <- forecast(ma(HC1_w.train.ts, order = 5), h = 28)
ma.CA1$mean
ma.CA1_df <- data.frame(ma.CA1)
rownames(ma.CA1_df) <- date_decimal(as.numeric(rownames(ma.CA1_df)))
acc.ma.CA1 <- accuracy(ma.CA1, HC1_w.valid.ts)
knitr::kable(acc.ma.CA1)
plot(ma.CA1)

# SARIMA
sarima.CA1 <- forecast(auto.arima(HC1_w.train.ts, D = 1), h = 28)
sarima.CA1$mean
sarima.CA1_df <- data.frame(sarima.CA1)
rownames(sarima.CA1_df) <- date_decimal(as.numeric(rownames(sarima.CA1_df)))
acc.sarima.CA1 <- accuracy(sarima.CA1, HC1_w.valid.ts)
knitr::kable(acc.sarima.CA1)
plot(sarima.CA1)

# HoltWinters
hw.CA1 <- forecast(HoltWinters(HC1_w.train.ts, seasonal = "additive"), h = 28)
hw.CA1$mean
hw.CA1.df <- data.frame(hw.CA1)
rownames(hw.CA1.df) <- date_decimal(as.numeric(rownames(hw.CA1.df)))
acc.hw.CA1 <- accuracy(hw.CA1, HC1_w.valid.ts)
knitr::kable(acc.hw.CA1)
plot(hw.CA1)


# State Space (Tbats)
tbats.CA1 <- forecast(tbats(HC1_w.train.ts), h = 28)
tbats.CA1$mean
tbats.CA1.df <- data.frame(tbats.CA1)
rownames(tbats.CA1.df) <- date_decimal(as.numeric(rownames(tbats.CA1.df)))
acc.tbats.CA1 <- accuracy(tbats.CA1, HC1_w.valid.ts)
knitr::kable(acc.tbats.CA1)
plot(tbats.CA1)


```
```{r}

# create a time series forecasting for the Hobbies CA2  data
weekly_df
HC2_w <- ts(weekly_df$wd_HC2, start= 2011, frequency = 52)
time = time(HC2_w)

# validation set is 10% of the data set
n.valid <- 28
n.train <- length(HC2_w) - n.valid
HC2_w.train.ts <- window(HC2_w, start=time[1], end=time[n.train])
HC2_w.valid.ts <- window(HC2_w, start=time[n.train+1], end=time[n.train+n.valid])

# Naive Hobbies 
naive.CA2 = naive(HC2_w.train.ts, h= 28)
naive.CA2$mean
naive.CA2_df = data.frame(naive.CA2)
rownames(naive.CA2_df) = date_decimal(as.numeric(rownames(naive.CA2_df)))
acc.naive.CA2 <- accuracy(naive.CA2, HC2_w.valid.ts)
knitr::kable(acc.naive.CA2)
plot(naive.CA2)

# Seasonal Naive Hobbies 
snaive.CA2 = snaive(HC2_w.train.ts, h= 28)
snaive.CA2$mean
snaive.CA2_df = data.frame(snaive.CA2)
rownames(snaive.CA2_df) = date_decimal(as.numeric(rownames(snaive.CA2_df)))
acc.snaive.CA2 <- accuracy(snaive.CA2, HC2_w.valid.ts)
knitr::kable(acc.snaive.CA2)
plot(snaive.CA2)

# Exponential Smoothing 
es.CA2 = ses(HC2_w.train.ts, h = 28)
es.CA2$mean
es.CA2_df <- data.frame(es.CA2)
rownames(es.CA2_df) <- date_decimal(as.numeric(rownames(es.CA2_df)))
acc.es.CA2 <- accuracy(es.CA2, HC2_w.valid.ts)
knitr::kable(acc.es.CA2)
plot(es.CA2)

# Moving Average
ma.CA2 <- forecast(ma(HC2_w.train.ts, order = 5), h = 28)
ma.CA2$mean
ma.CA2_df <- data.frame(ma.CA2)
rownames(ma.CA2_df) <- date_decimal(as.numeric(rownames(ma.CA2_df)))
acc.ma.CA2 <- accuracy(ma.CA2, HC2_w.valid.ts)
knitr::kable(acc.ma.CA2)
plot(ma.CA2)

# SARIMA
sarima.CA2 <- forecast(auto.arima(HC2_w.train.ts, D = 1), h = 28)
sarima.CA2$mean
sarima.CA2_df <- data.frame(sarima.CA2)
rownames(sarima.CA2_df) <- date_decimal(as.numeric(rownames(sarima.CA2_df)))
sarima.CA2_df
acc.sarima.CA2 <- accuracy(sarima.CA2, HC2_w.valid.ts)
knitr::kable(acc.sarima.CA2)
plot(sarima.CA2)

# Holt Winters
hw.CA2 <- forecast(HoltWinters(HC2_w.train.ts, seasonal = "additive"), h = 28)
hw.CA2$mean
hw.CA2.df <- data.frame(hw.CA2)
rownames(hw.CA2.df) <- date_decimal(as.numeric(rownames(hw.CA2.df)))
acc.hw.CA2 <- accuracy(hw.CA2, HC2_w.valid.ts)
knitr::kable(acc.hw.CA2)
plot(hw.CA2)


# State Space (Tbats)
tbats.CA2 <- forecast(tbats(HC2_w.train.ts), h = 28)
tbats.CA2$mean
tbats.CA2.df <- data.frame(tbats.CA2)
rownames(tbats.CA2.df) <- date_decimal(as.numeric(rownames(tbats.CA2.df)))
acc.tbats.CA2 <- accuracy(tbats.CA2, HC2_w.valid.ts)
knitr::kable(acc.tbats.CA2)
plot(tbats.CA2)

```

```{r}

# create a time series forecasting for the Hobbies CA3  data
HC3_w <- ts(weekly_df$wd_HC3, start= 2011, frequency = 52)
time = time(HC3_w)

# validation set is 10% of the data set
n.valid <- 28
n.train <- length(HC3_w) - n.valid
HC3_w.train.ts <- window(HC3_w, start=time[1], end=time[n.train])
HC3_w.valid.ts <- window(HC3_w, start=time[n.train+1], end=time[n.train+n.valid])

# Naive Hobbies 
naive.CA3 = naive(HC3_w.train.ts, h= 28)
naive.CA3$mean
naive.CA3_df = data.frame(naive.CA3)
rownames(naive.CA3_df) = date_decimal(as.numeric(rownames(naive.CA3_df)))
acc.naive.CA3 <- accuracy(naive.CA3, HC3_w.valid.ts)
knitr::kable(acc.naive.CA3)
plot(naive.CA3)

# Seasonal Naive Hobbies 
snaive.CA3 = snaive(HC3_w.train.ts, h= 28)
snaive.CA3$mean
snaive.CA3_df = data.frame(snaive.CA3)
rownames(snaive.CA3_df) = date_decimal(as.numeric(rownames(snaive.CA3_df)))
acc.snaive.CA3 <- accuracy(snaive.CA3, HC3_w.valid.ts)
knitr::kable(acc.snaive.CA3)
plot(snaive.CA3)

# Exponential Smoothing 
es.CA3 = ses(HC3_w.train.ts, h = 28)
es.CA3$mean
es.CA3_df <- data.frame(es.CA3)
rownames(es.CA3_df) <- date_decimal(as.numeric(rownames(es.CA3_df)))
acc.es.CA3 <- accuracy(es.CA3, HC3_w.valid.ts)
knitr::kable(acc.es.CA3)
plot(es.CA3)

# Moving Average
ma.CA3 <- forecast(ma(HC3_w.train.ts, order = 5), h = 28)
ma.CA3$mean
ma.CA3_df <- data.frame(ma.CA3)
rownames(ma.CA3_df) <- date_decimal(as.numeric(rownames(ma.CA3_df)))
acc.ma.CA3 <- accuracy(ma.CA3, HC3_w.valid.ts)
knitr::kable(acc.ma.CA3)
plot(ma.CA3)

# SARIMA
sarima.CA3 <- forecast(auto.arima(HC3_w.train.ts, D = 1), h = 28)
sarima.CA3$mean
sarima.CA3_df <- data.frame(sarima.CA3)
rownames(sarima.CA3_df) <- date_decimal(as.numeric(rownames(sarima.CA3_df)))
sarima.CA3_df
acc.sarima.CA3 <- accuracy(sarima.CA3, HC3_w.valid.ts)
knitr::kable(acc.sarima.CA3)
plot(sarima.CA3)

# Holt Winters
hw.CA3 <- forecast(HoltWinters(HC3_w.train.ts, seasonal = "additive"), h = 28)
hw.CA3$mean
hw.CA3.df <- data.frame(hw.CA3)
rownames(hw.CA3.df) <- date_decimal(as.numeric(rownames(hw.CA3.df)))
acc.hw.CA3 <- accuracy(hw.CA3, HC3_w.valid.ts)
knitr::kable(acc.hw.CA3)
plot(hw.CA3)


# State Space (Tbats)
tbats.CA3 <- forecast(tbats(HC3_w.train.ts), h = 28)
tbats.CA3$mean
tbats.CA3.df <- data.frame(tbats.CA3)
rownames(tbats.CA3.df) <- date_decimal(as.numeric(rownames(tbats.CA3.df)))
acc.tbats.CA3 <- accuracy(tbats.CA3, HC3_w.valid.ts)
knitr::kable(acc.tbats.CA3)
plot(tbats.CA3)


```

```{r}

# create a time series forecasting for the Food1 CA1  data
F1C1_w <- ts(weekly_df$wd_F1C1, start= 2011, frequency = 52)
time = time(F1C1_w)

# validation set is 10% of the data set
n.valid <- 28
n.train <- length(F1C1_w) - n.valid
F1C1_w.train.ts <- window(F1C1_w, start=time[1], end=time[n.train])
F1C1_w.valid.ts <- window(F1C1_w, start=time[n.train+1], end=time[n.train+n.valid])

# Naive Hobbies 
naive.F1C1 = naive(F1C1_w.train.ts, h= 28)
naive.F1C1$mean
naive.F1C1_df = data.frame(naive.F1C1)
rownames(naive.F1C1_df) = date_decimal(as.numeric(rownames(naive.F1C1_df)))
acc.naive.F1C1 <- accuracy(naive.F1C1, F1C1_w.valid.ts)
knitr::kable(acc.naive.F1C1)
plot(naive.F1C1)

# Seasonal Naive Hobbies 
snaive.F1C1 = snaive(F1C1_w.train.ts, h= 28)
snaive.F1C1$mean
snaive.F1C1_df = data.frame(snaive.F1C1)
rownames(snaive.F1C1_df) = date_decimal(as.numeric(rownames(snaive.F1C1_df)))
acc.snaive.F1C1 <- accuracy(snaive.F1C1, F1C1_w.valid.ts)
knitr::kable(acc.snaive.F1C1)
plot(snaive.F1C1)

# Exponential Smoothing 
es.F1C1 = ses(F1C1_w.train.ts, h = 28)
es.F1C1$mean
es.F1C1_df <- data.frame(es.F1C1)
rownames(es.F1C1_df) <- date_decimal(as.numeric(rownames(es.F1C1_df)))
acc.es.F1C1 <- accuracy(es.F1C1, F1C1_w.valid.ts)
knitr::kable(acc.es.F1C1)
plot(es.F1C1)

# Moving Average
ma.F1C1 <- forecast(ma(F1C1_w.train.ts, order = 5), h = 28)
ma.F1C1$mean
ma.F1C1_df <- data.frame(ma.F1C1)
rownames(ma.F1C1_df) <- date_decimal(as.numeric(rownames(ma.F1C1_df)))
acc.ma.F1C1 <- accuracy(ma.F1C1, F1C1_w.valid.ts)
knitr::kable(acc.ma.F1C1)
plot(ma.F1C1)

# SARIMA
sarima.F1C1 <- forecast(auto.arima(F1C1_w.train.ts, D = 1), h = 28)
sarima.F1C1$mean
sarima.F1C1_df <- data.frame(sarima.F1C1)
rownames(sarima.F1C1_df) <- date_decimal(as.numeric(rownames(sarima.F1C1_df)))
sarima.F1C1_df
acc.sarima.F1C1 <- accuracy(sarima.F1C1, F1C1_w.valid.ts)
knitr::kable(acc.sarima.F1C1)
plot(sarima.F1C1)

# Holt Winters
hw.F1C1 <- forecast(HoltWinters(F1C1_w.train.ts, seasonal = "additive"), h = 28)
hw.F1C1$mean
hw.F1C1.df <- data.frame(hw.F1C1)
rownames(hw.F1C1.df) <- date_decimal(as.numeric(rownames(hw.F1C1.df)))
acc.hw.F1C1 <- accuracy(hw.F1C1, F1C1_w.valid.ts)
knitr::kable(acc.hw.F1C1)
plot(hw.F1C1)

# State Space (Tbats)
tbats.F1C1 <- forecast(tbats(F1C1_w.train.ts), h = 28)
tbats.F1C1$mean
tbats.F1C1.df <- data.frame(tbats.F1C1)
rownames(tbats.F1C1.df) <- date_decimal(as.numeric(rownames(tbats.F1C1.df)))
acc.tbats.F1C1 <- accuracy(tbats.F1C1, F1C1_w.valid.ts)
knitr::kable(acc.tbats.F1C1)
plot(tbats.F1C1)
```

```{r}

# create a time series forecasting for the Food1 CA2  data
F1C2_w <- ts(weekly_df$wd_F1C2, start= 2011, frequency = 52)
time = time(F1C2_w)

# validation set is 10% of the data set
n.valid <- 28
n.train <- length(F1C2_w) - n.valid
F1C2_w.train.ts <- window(F1C2_w, start=time[1], end=time[n.train])
F1C2_w.valid.ts <- window(F1C2_w, start=time[n.train+1], end=time[n.train+n.valid])

# Naive Hobbies 
naive.F1C2 = naive(F1C2_w.train.ts, h= 28)
naive.F1C2$mean
naive.F1C2_df = data.frame(naive.F1C2)
rownames(naive.F1C2_df) = date_decimal(as.numeric(rownames(naive.F1C2_df)))
acc.naive.F1C2 <- accuracy(naive.F1C2, F1C2_w.valid.ts)
knitr::kable(acc.naive.F1C2)
plot(naive.F1C2)

# Seasonal Naive Hobbies 
snaive.F1C2 = snaive(F1C2_w.train.ts, h= 28)
snaive.F1C2$mean
snaive.F1C2_df = data.frame(snaive.F1C2)
rownames(snaive.F1C2_df) = date_decimal(as.numeric(rownames(snaive.F1C2_df)))
acc.snaive.F1C2 <- accuracy(snaive.F1C2, F1C2_w.valid.ts)
knitr::kable(acc.snaive.F1C2)
plot(snaive.F1C2)

# Exponential Smoothing 
es.F1C2 = ses(F1C2_w.train.ts, h = 28)
es.F1C2$mean
es.F1C2_df <- data.frame(es.F1C2)
rownames(es.F1C2_df) <- date_decimal(as.numeric(rownames(es.F1C2_df)))
acc.es.F1C2 <- accuracy(es.F1C2, F1C2_w.valid.ts)
knitr::kable(acc.es.F1C2)
plot(es.F1C2)

# Moving Average
ma.F1C2 <- forecast(ma(F1C2_w.train.ts, order = 5), h = 28)
ma.F1C2$mean
ma.F1C2_df <- data.frame(ma.F1C2)
rownames(ma.F1C2_df) <- date_decimal(as.numeric(rownames(ma.F1C2_df)))
acc.ma.F1C2 <- accuracy(ma.F1C2, F1C2_w.valid.ts)
knitr::kable(acc.ma.F1C2)
plot(ma.F1C2)

# SARIMA
sarima.F1C2 <- forecast(auto.arima(F1C2_w.train.ts, D = 1), h = 28)
sarima.F1C2$mean
sarima.F1C2_df <- data.frame(sarima.F1C2)
rownames(sarima.F1C2_df) <- date_decimal(as.numeric(rownames(sarima.F1C2_df)))
sarima.F1C2_df
acc.sarima.F1C2 <- accuracy(sarima.F1C2, F1C2_w.valid.ts)
knitr::kable(acc.sarima.F1C2)
plot(sarima.F1C2)

# Holt Winters
hw.F1C2 <- forecast(HoltWinters(F1C2_w.train.ts, seasonal = "additive"), h = 28)
hw.F1C2$mean
hw.F1C2.df <- data.frame(hw.F1C2)
rownames(hw.F1C2.df) <- date_decimal(as.numeric(rownames(hw.F1C2.df)))
acc.hw.F1C2 <- accuracy(hw.F1C2, F1C2_w.valid.ts)
knitr::kable(acc.hw.F1C2)
plot



# State Space (Tbats)
tbats.F1C2 <- forecast(tbats(F1C2_w.train.ts), h = 28)
tbats.F1C2$mean
tbats.F1C2.df <- data.frame(tbats.F1C2)
rownames(tbats.F1C2.df) <- date_decimal(as.numeric(rownames(tbats.F1C2.df)))
acc.tbats.F1C2 <- accuracy(tbats.F1C2, F1C2_w.valid.ts)
knitr::kable(acc.tbats.F1C2)
plot(tbats.F1C2)
```
```{r}

# create a time series forecasting for the Food1 CA3  data
F1C3_w <- ts(weekly_df$wd_F1C3, start= 2011, frequency = 52)
time = time(F1C3_w)

# validation set is 10% of the data set
n.valid <- 28
n.train <- length(F1C3_w) - n.valid
F1C3_w.train.ts <- window(F1C3_w, start=time[1], end=time[n.train])
F1C3_w.valid.ts <- window(F1C3_w, start=time[n.train+1], end=time[n.train+n.valid])

# Naive Hobbies 
naive.F1C3 = naive(F1C3_w.train.ts, h= 28)
naive.F1C3$mean
naive.F1C3_df = data.frame(naive.F1C3)
rownames(naive.F1C3_df) = date_decimal(as.numeric(rownames(naive.F1C3_df)))
acc.naive.F1C3 <- accuracy(naive.F1C3, F1C3_w.valid.ts)
knitr::kable(acc.naive.F1C3)
plot(naive.F1C3)

# Seasonal Naive Hobbies 
snaive.F1C3 = snaive(F1C3_w.train.ts, h= 28)
snaive.F1C3$mean
snaive.F1C3_df = data.frame(snaive.F1C3)
rownames(snaive.F1C3_df) = date_decimal(as.numeric(rownames(snaive.F1C3_df)))
acc.snaive.F1C3 <- accuracy(snaive.F1C3, F1C3_w.valid.ts)
knitr::kable(acc.snaive.F1C3)
plot(snaive.F1C3)

# Exponential Smoothing 
es.F1C3 = ses(F1C3_w.train.ts, h = 28)
es.F1C3$mean
es.F1C3_df <- data.frame(es.F1C3)
rownames(es.F1C3_df) <- date_decimal(as.numeric(rownames(es.F1C3_df)))
acc.es.F1C3 <- accuracy(es.F1C3, F1C3_w.valid.ts)
knitr::kable(acc.es.F1C3)
plot(es.F1C3)

# Moving Average
ma.F1C3 <- forecast(ma(F1C3_w.train.ts, order = 5), h = 28)
ma.F1C3$mean
ma.F1C3_df <- data.frame(ma.F1C3)
rownames(ma.F1C3_df) <- date_decimal(as.numeric(rownames(ma.F1C3_df)))
acc.ma.F1C3 <- accuracy(ma.F1C3, F1C3_w.valid.ts)
knitr::kable(acc.ma.F1C3)
plot(ma.F1C3)

# SARIMA
sarima.F1C3 <- forecast(auto.arima(F1C3_w.train.ts, D = 1), h = 28)
sarima.F1C3$mean
sarima.F1C3_df <- data.frame(sarima.F1C3)
rownames(sarima.F1C3_df) <- date_decimal(as.numeric(rownames(sarima.F1C3_df)))
sarima.F1C3_df
acc.sarima.F1C3 <- accuracy(sarima.F1C3, F1C3_w.valid.ts)
knitr::kable(acc.sarima.F1C3)
plot(sarima.F1C3)

# Holt Winters
hw.F1C3 <- forecast(HoltWinters(F1C3_w.train.ts, seasonal = "additive"), h = 28)
hw.F1C3$mean
hw.F1C3.df <- data.frame(hw.F1C3)
rownames(hw.F1C3.df) <- date_decimal(as.numeric(rownames(hw.F1C3.df)))
acc.hw.F1C3 <- accuracy(hw.F1C1, F1C3_w.valid.ts)
knitr::kable(acc.hw.F1C3)
plot(hw.F1C3)


# State Space (Tbats)
tbats.F1C3 <- forecast(tbats(F1C3_w.train.ts), h = 28)
tbats.F1C3$mean
tbats.F1C3.df <- data.frame(tbats.F1C3)
rownames(tbats.F1C3.df) <- date_decimal(as.numeric(rownames(tbats.F1C3.df)))
acc.tbats.F1C3 <- accuracy(tbats.F1C3, F1C3_w.valid.ts)
knitr::kable(acc.tbats.F1C3)
plot(tbats.F1C3)
```
```{r}
# create a time series forecasting for the Food2 CA1  data
F2C1_w <- ts(weekly_df$wd_F2C1, start= 2011, frequency = 52)
time = time(F2C1_w)

# validation set is 10% of the data set
n.valid <- 28
n.train <- length(F2C1_w) - n.valid
F2C1_w.train.ts <- window(F2C1_w, start=time[1], end=time[n.train])
F2C1_w.valid.ts <- window(F2C1_w, start=time[n.train+1], end=time[n.train+n.valid])

# Naive Hobbies 
naive.F2C1 = naive(F2C1_w.train.ts, h= 28)
naive.F2C1$mean
naive.F2C1_df = data.frame(naive.F2C1)
rownames(naive.F2C1_df) = date_decimal(as.numeric(rownames(naive.F2C1_df)))
acc.naive.F2C1 <- accuracy(naive.F2C1, F2C1_w.valid.ts)
knitr::kable(acc.naive.F2C1)
plot(naive.F2C1)

# Seasonal Naive Hobbies 
snaive.F2C1 = snaive(F2C1_w.train.ts, h= 28)
snaive.F2C1$mean
snaive.F2C1_df = data.frame(snaive.F2C1)
rownames(snaive.F2C1_df) = date_decimal(as.numeric(rownames(snaive.F2C1_df)))
acc.snaive.F2C1 <- accuracy(snaive.F2C1, F2C1_w.valid.ts)
knitr::kable(acc.snaive.F2C1)
plot(snaive.F2C1)

# Exponential Smoothing 
es.F2C1 = ses(F2C1_w.train.ts, h = 28)
es.F2C1$mean
es.F2C1_df <- data.frame(es.F2C1)
rownames(es.F2C1_df) <- date_decimal(as.numeric(rownames(es.F2C1_df)))
acc.es.F2C1 <- accuracy(es.F2C1, F2C1_w.valid.ts)
knitr::kable(acc.es.F2C1)
plot(es.F2C1)

# Moving Average
ma.F2C1 <- forecast(ma(F2C1_w.train.ts, order = 5), h = 28)
ma.F2C1$mean
ma.F2C1_df <- data.frame(ma.F2C1)
rownames(ma.F2C1_df) <- date_decimal(as.numeric(rownames(ma.F2C1_df)))
acc.ma.F2C1 <- accuracy(ma.F2C1, F2C1_w.valid.ts)
knitr::kable(acc.ma.F2C1)
plot(ma.F2C1)

# SARIMA
sarima.F2C1 <- forecast(auto.arima(F2C1_w.train.ts, D = 1), h = 28)
sarima.F2C1$mean
sarima.F2C1_df <- data.frame(sarima.F2C1)
rownames(sarima.F2C1_df) <- date_decimal(as.numeric(rownames(sarima.F2C1_df)))
acc.sarima.F2C1 <- accuracy(sarima.F2C1, F2C1_w.valid.ts)
knitr::kable(acc.sarima.F2C1)
plot(sarima.F2C1)

# Holt Winters
hw.F2C1 <- forecast(HoltWinters(F2C1_w.train.ts, seasonal = "additive"), h = 28)
hw.F2C1$mean
hw.F2C1.df <- data.frame(hw.F2C1)
rownames(hw.F2C1.df) <- date_decimal(as.numeric(rownames(hw.F2C1.df)))
acc.hw.F2C1 <- accuracy(hw.F1C1, F2C1_w.valid.ts)
knitr::kable(acc.hw.F2C1)
plot(hw.F2C1)

# State Space (Tbats)
tbats.F2C1 <- forecast(tbats(F2C1_w.train.ts), h = 28)
tbats.F2C1$mean
tbats.F2C1.df <- data.frame(tbats.F2C1)
rownames(tbats.F2C1.df) <- date_decimal(as.numeric(rownames(tbats.F2C1.df)))
acc.tbats.F2C1 <- accuracy(tbats.F2C1, F2C1_w.valid.ts)
knitr::kable(acc.tbats.F2C1)
plot(tbats.F2C1)
```
```{r}
# create a time series forecasting for the Food2 CA2  data
F2C2_w <- ts(weekly_df$wd_F2C2, start= 2011, frequency = 52)
time = time(F2C2_w)

# validation set is 10% of the data set
n.valid <- 28
n.train <- length(F2C2_w) - n.valid
F2C2_w.train.ts <- window(F2C2_w, start=time[1], end=time[n.train])
F2C2_w.valid.ts <- window(F2C2_w, start=time[n.train+1], end=time[n.train+n.valid])

# Naive Hobbies 
naive.F2C2 = naive(F2C2_w.train.ts, h= 28)
naive.F2C2$mean
naive.F2C2_df = data.frame(naive.F2C2)
rownames(naive.F2C2_df) = date_decimal(as.numeric(rownames(naive.F2C2_df)))
acc.naive.F2C2 <- accuracy(naive.F2C2, F2C2_w.valid.ts)
knitr::kable(acc.naive.F2C2)
plot(naive.F2C2)

# Seasonal Naive Hobbies 
snaive.F2C2 = snaive(F2C2_w.train.ts, h= 28)
snaive.F2C2$mean
snaive.F2C2_df = data.frame(snaive.F2C2)
rownames(snaive.F2C2_df) = date_decimal(as.numeric(rownames(snaive.F2C2_df)))
acc.snaive.F2C2 <- accuracy(snaive.F2C2, F2C2_w.valid.ts)
knitr::kable(acc.snaive.F2C2)
plot(snaive.F2C2)

# Exponential Smoothing 
es.F2C2 = ses(F2C2_w.train.ts, h = 28)
es.F2C2$mean
es.F2C2_df <- data.frame(es.F2C2)
rownames(es.F2C2_df) <- date_decimal(as.numeric(rownames(es.F2C2_df)))
acc.es.F2C2 <- accuracy(es.F2C2, F2C2_w.valid.ts)
knitr::kable(acc.es.F2C2)
plot(es.F2C2)

# Moving Average
ma.F2C2 <- forecast(ma(F2C2_w.train.ts, order = 5), h = 28)
ma.F2C2$mean
ma.F2C2_df <- data.frame(ma.F2C2)
rownames(ma.F2C2_df) <- date_decimal(as.numeric(rownames(ma.F2C2_df)))
acc.ma.F2C2 <- accuracy(ma.F2C2, F2C2_w.valid.ts)
knitr::kable(acc.ma.F2C2)
plot(ma.F2C2)

# SARIMA
sarima.F2C2 <- forecast(auto.arima(F2C2_w.train.ts, D = 1), h = 28)
sarima.F2C2$mean
sarima.F2C2_df <- data.frame(sarima.F2C2)
rownames(sarima.F2C2_df) <- date_decimal(as.numeric(rownames(sarima.F2C2_df)))
acc.sarima.F2C2 <- accuracy(sarima.F2C2, F2C2_w.valid.ts)
knitr::kable(acc.sarima.F2C2)
plot(sarima.F2C2)

# Holt Winters
hw.F2C2 <- forecast(HoltWinters(F2C2_w.train.ts, seasonal = "additive"), h = 28)
hw.F2C2$mean
hw.F2C2.df <- data.frame(hw.F2C2)
rownames(hw.F2C2.df) <- date_decimal(as.numeric(rownames(hw.F2C2.df)))
acc.hw.F2C2 <- accuracy(hw.F1C1, F2C2_w.valid.ts)
knitr::kable(acc.hw.F2C2)
plot(hw.F2C2)

# State Space (Tbats)
tbats.F2C2 <- forecast(tbats(F2C2_w.train.ts), h = 28)
tbats.F2C2$mean
tbats.F2C2.df <- data.frame(tbats.F2C2)
rownames(tbats.F2C2.df) <- date_decimal(as.numeric(rownames(tbats.F2C2.df)))
acc.tbats.F2C2 <- accuracy(tbats.F2C2, F2C2_w.valid.ts)
knitr::kable(acc.tbats.F2C2)
plot(tbats.F2C2)
```
```{r}

# create a time series forecasting for the Food2 CA3  data
F2C3_w <- ts(weekly_df$wd_F2C3, start= 2011, frequency = 52)
time = time(F2C3_w)

# validation set is 10% of the data set
n.valid <- 28
n.train <- length(F2C3_w) - n.valid
F2C3_w.train.ts <- window(F2C3_w, start=time[1], end=time[n.train])
F2C3_w.valid.ts <- window(F2C3_w, start=time[n.train+1], end=time[n.train+n.valid])

# Naive Hobbies 
naive.F2C3 = naive(F2C3_w.train.ts, h= 28)
naive.F2C3$mean
naive.F2C3_df = data.frame(naive.F2C3)
rownames(naive.F2C3_df) = date_decimal(as.numeric(rownames(naive.F2C3_df)))
acc.naive.F2C3 <- accuracy(naive.F2C3, F2C3_w.valid.ts)
knitr::kable(acc.naive.F2C3)
plot(naive.F2C3)

# Seasonal Naive Hobbies 
snaive.F2C3 = snaive(F2C3_w.train.ts, h= 28)
snaive.F2C3$mean
snaive.F2C3_df = data.frame(snaive.F2C3)
rownames(snaive.F2C3_df) = date_decimal(as.numeric(rownames(snaive.F2C3_df)))
acc.snaive.F2C3 <- accuracy(snaive.F2C3, F2C3_w.valid.ts)
knitr::kable(acc.snaive.F2C3)
plot(snaive.F2C3)

# Exponential Smoothing 
es.F2C3 = ses(F2C3_w.train.ts, h = 28)
es.F2C3$mean
es.F2C3_df <- data.frame(es.F2C3)
rownames(es.F2C3_df) <- date_decimal(as.numeric(rownames(es.F2C3_df)))
acc.es.F2C3 <- accuracy(es.F2C3, F2C3_w.valid.ts)
knitr::kable(acc.es.F2C3)
plot(es.F2C3)

# Moving Average
ma.F2C3 <- forecast(ma(F2C3_w.train.ts, order = 5), h = 28)
ma.F2C3$mean
ma.F2C3_df <- data.frame(ma.F2C3)
rownames(ma.F2C3_df) <- date_decimal(as.numeric(rownames(ma.F2C3_df)))
acc.ma.F2C3 <- accuracy(ma.F2C3, F2C3_w.valid.ts)
knitr::kable(acc.ma.F2C3)
plot(ma.F2C3)

# SARIMA
sarima.F2C3 <- forecast(auto.arima(F2C3_w.train.ts, D = 1), h = 28)
sarima.F2C3$mean
sarima.F2C3_df <- data.frame(sarima.F2C3)
rownames(sarima.F2C3_df) <- date_decimal(as.numeric(rownames(sarima.F2C3_df)))
acc.sarima.F2C3 <- accuracy(sarima.F2C3, F2C3_w.valid.ts)
knitr::kable(acc.sarima.F2C3)
plot(sarima.F2C3)

# Holt Winters
hw.F2C3 <- forecast(HoltWinters(F2C3_w.train.ts, seasonal = "additive"), h = 28)
hw.F2C3$mean
hw.F2C3.df <- data.frame(hw.F2C3)
rownames(hw.F2C3.df) <- date_decimal(as.numeric(rownames(hw.F2C3.df)))
acc.hw.F2C3 <- accuracy(hw.F1C1, F2C3_w.valid.ts)
knitr::kable(acc.hw.F2C3)
plot(hw.F2C3)

# State Space (Tbats)
tbats.F2C3 <- forecast(tbats(F2C3_w.train.ts), h = 28)
tbats.F2C3$mean
tbats.F2C3.df <- data.frame(tbats.F2C3)
rownames(tbats.F2C3.df) <- date_decimal(as.numeric(rownames(tbats.F2C3.df)))
acc.tbats.F2C3 <- accuracy(tbats.F2C3, F2C3_w.valid.ts)
knitr::kable(acc.tbats.F2C3)
plot(tbats.F2C3)
```


```{r}

# create a time series forecasting for the Food3 CA1  data
F3C1_w <- ts(weekly_df$wd_F3C1, start= 2011, frequency = 52)
time = time(F3C1_w)

# validation set is 10% of the data set
n.valid <- 28
n.train <- length(F3C1_w) - n.valid
F3C1_w.train.ts <- window(F3C1_w, start=time[1], end=time[n.train])
F3C1_w.valid.ts <- window(F3C1_w, start=time[n.train+1], end=time[n.train+n.valid])

# Naive Hobbies 
naive.F3C1 = naive(F3C1_w.train.ts, h= 28)
naive.F3C1$mean
naive.F3C1_df = data.frame(naive.F3C1)
rownames(naive.F3C1_df) = date_decimal(as.numeric(rownames(naive.F3C1_df)))
acc.naive.F3C1 <- accuracy(naive.F3C1, F3C1_w.valid.ts)
knitr::kable(acc.naive.F3C1)
plot(naive.F3C1)

# Seasonal Naive Hobbies 
snaive.F3C1 = snaive(F3C1_w.train.ts, h= 28)
snaive.F3C1$mean
snaive.F3C1_df = data.frame(snaive.F3C1)
rownames(snaive.F3C1_df) = date_decimal(as.numeric(rownames(snaive.F3C1_df)))
acc.snaive.F3C1 <- accuracy(snaive.F3C1, F3C1_w.valid.ts)
knitr::kable(acc.snaive.F3C1)
plot(snaive.F3C1)

# Exponential Smoothing 
es.F3C1 = ses(F3C1_w.train.ts, h = 28)
es.F3C1$mean
es.F3C1_df <- data.frame(es.F3C1)
rownames(es.F3C1_df) <- date_decimal(as.numeric(rownames(es.F3C1_df)))
acc.es.F3C1 <- accuracy(es.F3C1, F3C1_w.valid.ts)
knitr::kable(acc.es.F3C1)
plot(es.F3C1)

# Moving Average
ma.F3C1 <- forecast(ma(F3C1_w.train.ts, order = 5), h = 28)
ma.F3C1$mean
ma.F3C1_df <- data.frame(ma.F3C1)
rownames(ma.F3C1_df) <- date_decimal(as.numeric(rownames(ma.F3C1_df)))
acc.ma.F3C1 <- accuracy(ma.F3C1, F3C1_w.valid.ts)
knitr::kable(acc.ma.F3C1)
plot(ma.F3C1)

# SARIMA
sarima.F3C1 <- forecast(auto.arima(F3C1_w.train.ts, D = 1), h = 28)
sarima.F3C1$mean
sarima.F3C1_df <- data.frame(sarima.F3C1)
rownames(sarima.F3C1_df) <- date_decimal(as.numeric(rownames(sarima.F3C1_df)))
acc.sarima.F3C1 <- accuracy(sarima.F3C1, F3C1_w.valid.ts)
knitr::kable(acc.sarima.F3C1)
plot(sarima.F3C1)

# Holt Winters
hw.F3C1 <- forecast(HoltWinters(F3C1_w.train.ts, seasonal = "additive"), h = 28)
hw.F3C1$mean
hw.F3C1.df <- data.frame(hw.F3C1)
rownames(hw.F3C1.df) <- date_decimal(as.numeric(rownames(hw.F3C1.df)))
acc.hw.F3C1 <- accuracy(hw.F1C1, F3C1_w.valid.ts)
knitr::kable(acc.hw.F3C1)
plot(hw.F3C1)


# State Space (Tbats)
tbats.F3C1 <- forecast(tbats(F3C1_w.train.ts), h = 28)
tbats.F3C1$mean
tbats.F3C1.df <- data.frame(tbats.F3C1)
rownames(tbats.F3C1.df) <- date_decimal(as.numeric(rownames(tbats.F3C1.df)))
acc.tbats.F3C1 <- accuracy(tbats.F3C1, F3C1_w.valid.ts)
knitr::kable(acc.tbats.F3C1)
plot(tbats.F3C1)
```


```{r}

# create a time series forecasting for the Food3 CA2  data
F3C2_w <- ts(weekly_df$wd_F3C2, start= 2011, frequency = 52)
time = time(F3C2_w)

# validation set is 10% of the data set
n.valid <- 28
n.train <- length(F3C2_w) - n.valid
F3C2_w.train.ts <- window(F3C2_w, start=time[1], end=time[n.train])
F3C2_w.valid.ts <- window(F3C2_w, start=time[n.train+1], end=time[n.train+n.valid])

# Naive Hobbies 
naive.F3C2 = naive(F3C2_w.train.ts, h= 28)
naive.F3C2$mean
naive.F3C2_df = data.frame(naive.F3C2)
rownames(naive.F3C2_df) = date_decimal(as.numeric(rownames(naive.F3C2_df)))
acc.naive.F3C2 <- accuracy(naive.F3C2, F3C2_w.valid.ts)
knitr::kable(acc.naive.F3C2)
plot(naive.F3C2)

# Seasonal Naive Hobbies 
snaive.F3C2 = snaive(F3C2_w.train.ts, h= 28)
snaive.F3C2$mean
snaive.F3C2_df = data.frame(snaive.F3C2)
rownames(snaive.F3C2_df) = date_decimal(as.numeric(rownames(snaive.F3C2_df)))
acc.snaive.F3C2 <- accuracy(snaive.F3C2, F3C2_w.valid.ts)
knitr::kable(acc.snaive.F3C2)
plot(snaive.F3C2)

# Exponential Smoothing 
es.F3C2 = ses(F3C2_w.train.ts, h = 28)
es.F3C2$mean
es.F3C2_df <- data.frame(es.F3C2)
rownames(es.F3C2_df) <- date_decimal(as.numeric(rownames(es.F3C2_df)))
acc.es.F3C2 <- accuracy(es.F3C2, F3C2_w.valid.ts)
knitr::kable(acc.es.F3C2)
plot(es.F3C2)

# Moving Average
ma.F3C2 <- forecast(ma(F3C2_w.train.ts, order = 5), h = 28)
ma.F3C2$mean
ma.F3C2_df <- data.frame(ma.F3C2)
rownames(ma.F3C2_df) <- date_decimal(as.numeric(rownames(ma.F3C2_df)))
acc.ma.F3C2 <- accuracy(ma.F3C2, F3C2_w.valid.ts)
knitr::kable(acc.ma.F3C2)
plot(ma.F3C2)

# SARIMA
sarima.F3C2 <- forecast(auto.arima(F3C2_w.train.ts, D = 1), h = 28)
sarima.F3C2$mean
sarima.F3C2_df <- data.frame(sarima.F3C2)
rownames(sarima.F3C2_df) <- date_decimal(as.numeric(rownames(sarima.F3C2_df)))
acc.sarima.F3C2 <- accuracy(sarima.F3C2, F3C2_w.valid.ts)
knitr::kable(acc.sarima.F3C2)
plot(sarima.F3C2)

# Holt Winters
hw.F3C2 <- forecast(HoltWinters(F3C2_w.train.ts, seasonal = "additive"), h = 28)
hw.F3C2$mean
hw.F3C2.df <- data.frame(hw.F3C2)
rownames(hw.F3C2.df) <- date_decimal(as.numeric(rownames(hw.F3C2.df)))
acc.hw.F3C2 <- accuracy(hw.F1C1, F3C2_w.valid.ts)
knitr::kable(acc.hw.F3C2)
plot(hw.F3C2)



# State Space (Tbats)
tbats.F3C2 <- forecast(tbats(F3C2_w.train.ts), h = 28)
tbats.F3C2$mean
tbats.F3C2.df <- data.frame(tbats.F3C2)
rownames(tbats.F3C2.df) <- date_decimal(as.numeric(rownames(tbats.F3C2.df)))
acc.tbats.F3C2 <- accuracy(tbats.F3C2, F3C2_w.valid.ts)
knitr::kable(acc.tbats.F3C2)
plot(tbats.F3C2)
```


```{r}

# create a time series forecasting for the Food3 CA3  data
F3C3_w <- ts(weekly_df$wd_F3C3, start= 2011, frequency = 52)
time = time(F3C3_w)

# validation set is 10% of the data set
n.valid <- 28
n.train <- length(F3C3_w) - n.valid
F3C3_w.train.ts <- window(F3C3_w, start=time[1], end=time[n.train])
F3C3_w.valid.ts <- window(F3C3_w, start=time[n.train+1], end=time[n.train+n.valid])

# Naive Hobbies 
naive.F3C3 = naive(F3C3_w.train.ts, h= 28)
naive.F3C3$mean
naive.F3C3_df = data.frame(naive.F3C3)
rownames(naive.F3C3_df) = date_decimal(as.numeric(rownames(naive.F3C3_df)))
acc.naive.F3C3 <- accuracy(naive.F3C3, F3C3_w.valid.ts)
knitr::kable(acc.naive.F3C3)
plot(naive.F3C3)

# Seasonal Naive Hobbies 
snaive.F3C3 = snaive(F3C3_w.train.ts, h= 28)
snaive.F3C3$mean
snaive.F3C3_df = data.frame(snaive.F3C3)
rownames(snaive.F3C3_df) = date_decimal(as.numeric(rownames(snaive.F3C3_df)))
acc.snaive.F3C3 <- accuracy(snaive.F3C3, F3C3_w.valid.ts)
knitr::kable(acc.snaive.F3C3)
plot(snaive.F3C3)

# Exponential Smoothing 
es.F3C3 = ses(F3C3_w.train.ts, h = 28)
es.F3C3$mean
es.F3C3_df <- data.frame(es.F3C3)
rownames(es.F3C3_df) <- date_decimal(as.numeric(rownames(es.F3C3_df)))
acc.es.F3C3 <- accuracy(es.F3C3, F3C3_w.valid.ts)
knitr::kable(acc.es.F3C3)
plot(es.F3C3)

# Moving Average
ma.F3C3 <- forecast(ma(F3C3_w.train.ts, order = 5), h = 28)
ma.F3C3$mean
ma.F3C3_df <- data.frame(ma.F3C3)
rownames(ma.F3C3_df) <- date_decimal(as.numeric(rownames(ma.F3C3_df)))
acc.ma.F3C3 <- accuracy(ma.F3C3, F3C3_w.valid.ts)
knitr::kable(acc.ma.F3C3)
plot(ma.F3C3)

# SARIMA
sarima.F3C3 <- forecast(auto.arima(F3C3_w.train.ts, D = 1), h = 28)
sarima.F3C3$mean
sarima.F3C3_df <- data.frame(sarima.F3C3)
rownames(sarima.F3C3_df) <- date_decimal(as.numeric(rownames(sarima.F3C3_df)))
acc.sarima.F3C3 <- accuracy(sarima.F3C3, F3C3_w.valid.ts)
knitr::kable(acc.sarima.F3C3)
plot(sarima.F3C3)

# Holt Winters
hw.F3C3 <- forecast(HoltWinters(F3C3_w.train.ts, seasonal = "additive"), h = 28)
hw.F3C3$mean
hw.F3C3.df <- data.frame(hw.F3C3)
rownames(hw.F3C3.df) <- date_decimal(as.numeric(rownames(hw.F3C3.df)))
acc.hw.F3C3 <- accuracy(hw.F1C1, F3C3_w.valid.ts)
knitr::kable(acc.hw.F3C3)
plot(hw.F3C3)


# State Space (Tbats)
tbats.F3C3 <- forecast(tbats(F3C3_w.train.ts), h = 28)
tbats.F3C3$mean
tbats.F3C3.df <- data.frame(tbats.F3C3)
rownames(tbats.F3C3.df) <- date_decimal(as.numeric(rownames(tbats.F3C3.df)))
acc.tbats.F3C3 <- accuracy(tbats.F3C3, F3C3_w.valid.ts)
knitr::kable(acc.tbats.F3C3)
plot(tbats.F3C3)

```

```{r}

# create a time series forecasting for the HH1 CA1 data
HH1C1_w <- ts(weekly_df$wd_HH1C1, start= 2011, frequency = 52)
time = time(HH1C1_w)

# validation set is 10% of the data set
n.valid <- 28
n.train <- length(HH1C1_w) - n.valid
HH1C1_w.train.ts <- window(HH1C1_w, start=time[1], end=time[n.train])
HH1C1_w.valid.ts <- window(HH1C1_w, start=time[n.train+1], end=time[n.train+n.valid])

# Naive Hobbies 
naive.HH1C1 = naive(HH1C1_w.train.ts, h= 28)
naive.HH1C1$mean
naive.HH1C1_df = data.frame(naive.HH1C1)
rownames(naive.HH1C1_df) = date_decimal(as.numeric(rownames(naive.HH1C1_df)))
acc.naive.HH1C1 <- accuracy(naive.HH1C1, HH1C1_w.valid.ts)
knitr::kable(acc.naive.HH1C1)
plot(naive.HH1C1)

# Seasonal Naive Hobbies 
snaive.HH1C1 = snaive(HH1C1_w.train.ts, h= 28)
snaive.HH1C1$mean
snaive.HH1C1_df = data.frame(snaive.HH1C1)
rownames(snaive.HH1C1_df) = date_decimal(as.numeric(rownames(snaive.HH1C1_df)))
acc.snaive.HH1C1 <- accuracy(snaive.HH1C1, HH1C1_w.valid.ts)
knitr::kable(acc.snaive.HH1C1)
plot(snaive.HH1C1)

# Exponential Smoothing 
es.HH1C1 = ses(HH1C1_w.train.ts, h = 28)
es.HH1C1$mean
es.HH1C1_df <- data.frame(es.HH1C1)
rownames(es.HH1C1_df) <- date_decimal(as.numeric(rownames(es.HH1C1_df)))
acc.es.HH1C1 <- accuracy(es.HH1C1, HH1C1_w.valid.ts)
knitr::kable(acc.es.HH1C1)
plot(es.HH1C1)

# Moving Average
ma.HH1C1 <- forecast(ma(HH1C1_w.train.ts, order = 5), h = 28)
ma.HH1C1$mean
ma.HH1C1_df <- data.frame(ma.HH1C1)
rownames(ma.HH1C1_df) <- date_decimal(as.numeric(rownames(ma.HH1C1_df)))
acc.ma.HH1C1 <- accuracy(ma.HH1C1, HH1C1_w.valid.ts)
knitr::kable(acc.ma.HH1C1)
plot(ma.HH1C1)

# SARIMA
sarima.HH1C1 <- forecast(auto.arima(HH1C1_w.train.ts, D = 1), h = 28)
sarima.HH1C1$mean
sarima.HH1C1_df <- data.frame(sarima.HH1C1)
rownames(sarima.HH1C1_df) <- date_decimal(as.numeric(rownames(sarima.HH1C1_df)))
acc.sarima.HH1C1 <- accuracy(sarima.HH1C1, HH1C1_w.valid.ts)
knitr::kable(acc.sarima.HH1C1)
plot(sarima.HH1C1)

# Holt Winters
hw.HH1C1 <- forecast(HoltWinters(HH1C1_w.train.ts, seasonal = "additive"), h = 28)
hw.HH1C1$mean
hw.HH1C1.df <- data.frame(hw.HH1C1)
rownames(hw.HH1C1.df) <- date_decimal(as.numeric(rownames(hw.HH1C1.df)))
acc.hw.HH1C1 <- accuracy(hw.F1C1, HH1C1_w.valid.ts)
knitr::kable(acc.hw.HH1C1)
plot(hw.HH1C1)



# State Space (Tbats)
tbats.HH1C1 <- forecast(tbats(HH1C1_w.train.ts), h = 28)
tbats.HH1C1$mean
tbats.HH1C1.df <- data.frame(tbats.HH1C1)
rownames(tbats.HH1C1.df) <- date_decimal(as.numeric(rownames(tbats.HH1C1.df)))
acc.tbats.HH1C1 <- accuracy(tbats.HH1C1, HH1C1_w.valid.ts)
knitr::kable(acc.tbats.HH1C1)
plot(tbats.HH1C1)
```


```{r}

# create a time series forecasting for the HH1 CA2 data
HH1C2_w <- ts(weekly_df$wd_HH1C2, start= 2011, frequency = 52)
time = time(HH1C2_w)

# validation set is 10% of the data set
n.valid <- 28
n.train <- length(HH1C2_w) - n.valid
HH1C2_w.train.ts <- window(HH1C2_w, start=time[1], end=time[n.train])
HH1C2_w.valid.ts <- window(HH1C2_w, start=time[n.train+1], end=time[n.train+n.valid])

# Naive Hobbies 
naive.HH1C2 = naive(HH1C2_w.train.ts, h= 28)
naive.HH1C2$mean
naive.HH1C2_df = data.frame(naive.HH1C2)
rownames(naive.HH1C2_df) = date_decimal(as.numeric(rownames(naive.HH1C2_df)))
acc.naive.HH1C2 <- accuracy(naive.HH1C2, HH1C2_w.valid.ts)
knitr::kable(acc.naive.HH1C2)
plot(naive.HH1C2)

# Seasonal Naive Hobbies 
snaive.HH1C2 = snaive(HH1C2_w.train.ts, h= 28)
snaive.HH1C2$mean
snaive.HH1C2_df = data.frame(snaive.HH1C2)
rownames(snaive.HH1C2_df) = date_decimal(as.numeric(rownames(snaive.HH1C2_df)))
acc.snaive.HH1C2 <- accuracy(snaive.HH1C2, HH1C2_w.valid.ts)
knitr::kable(acc.snaive.HH1C2)
plot(snaive.HH1C2)

# Exponential Smoothing 
es.HH1C2 = ses(HH1C2_w.train.ts, h = 28)
es.HH1C2$mean
es.HH1C2_df <- data.frame(es.HH1C2)
rownames(es.HH1C2_df) <- date_decimal(as.numeric(rownames(es.HH1C2_df)))
acc.es.HH1C2 <- accuracy(es.HH1C2, HH1C2_w.valid.ts)
knitr::kable(acc.es.HH1C2)
plot(es.HH1C2)

# Moving Average
ma.HH1C2 <- forecast(ma(HH1C2_w.train.ts, order = 5), h = 28)
ma.HH1C2$mean
ma.HH1C2_df <- data.frame(ma.HH1C2)
rownames(ma.HH1C2_df) <- date_decimal(as.numeric(rownames(ma.HH1C2_df)))
acc.ma.HH1C2 <- accuracy(ma.HH1C2, HH1C2_w.valid.ts)
knitr::kable(acc.ma.HH1C2)
plot(ma.HH1C2)

# SARIMA
sarima.HH1C2 <- forecast(auto.arima(HH1C2_w.train.ts, D = 1), h = 28)
sarima.HH1C2$mean
sarima.HH1C2_df <- data.frame(sarima.HH1C2)
rownames(sarima.HH1C2_df) <- date_decimal(as.numeric(rownames(sarima.HH1C2_df)))
acc.sarima.HH1C2 <- accuracy(sarima.HH1C2, HH1C2_w.valid.ts)
knitr::kable(acc.sarima.HH1C2)
plot(sarima.HH1C2)

# Holt Winters
hw.HH1C2 <- forecast(HoltWinters(HH1C2_w.train.ts, seasonal = "additive"), h = 28)
hw.HH1C2$mean
hw.HH1C2.df <- data.frame(hw.HH1C2)
rownames(hw.HH1C2.df) <- date_decimal(as.numeric(rownames(hw.HH1C2.df)))
acc.hw.HH1C2 <- accuracy(hw.F1C2, HH1C2_w.valid.ts)
knitr::kable(acc.hw.HH1C2)
plot(hw.HH1C2)



# State Space (Tbats)
tbats.HH1C2 <- forecast(tbats(HH1C2_w.train.ts), h = 28)
tbats.HH1C2$mean
tbats.HH1C2.df <- data.frame(tbats.HH1C2)
rownames(tbats.HH1C2.df) <- date_decimal(as.numeric(rownames(tbats.HH1C2.df)))
acc.tbats.HH1C2 <- accuracy(tbats.HH1C2, HH1C2_w.valid.ts)
knitr::kable(acc.tbats.HH1C2)
plot(tbats.HH1C2)
```


```{r}

# create a time series forecasting for the HH1 CA3 data
HH1C3_w <- ts(weekly_df$wd_HH1C3, start= 2011, frequency = 52)
time = time(HH1C3_w)

# validation set is 10% of the data set
n.valid <- 28
n.train <- length(HH1C3_w) - n.valid
HH1C3_w.train.ts <- window(HH1C3_w, start=time[1], end=time[n.train])
HH1C3_w.valid.ts <- window(HH1C3_w, start=time[n.train+1], end=time[n.train+n.valid])

# Naive Hobbies 
naive.HH1C3 = naive(HH1C3_w.train.ts, h= 28)
naive.HH1C3$mean
naive.HH1C3_df = data.frame(naive.HH1C3)
rownames(naive.HH1C3_df) = date_decimal(as.numeric(rownames(naive.HH1C3_df)))
acc.naive.HH1C3 <- accuracy(naive.HH1C3, HH1C3_w.valid.ts)
knitr::kable(acc.naive.HH1C3)
plot(naive.HH1C3)

# Seasonal Naive Hobbies 
snaive.HH1C3 = snaive(HH1C3_w.train.ts, h= 28)
snaive.HH1C3$mean
snaive.HH1C3_df = data.frame(snaive.HH1C3)
rownames(snaive.HH1C3_df) = date_decimal(as.numeric(rownames(snaive.HH1C3_df)))
acc.snaive.HH1C3 <- accuracy(snaive.HH1C3, HH1C3_w.valid.ts)
knitr::kable(acc.snaive.HH1C3)
plot(snaive.HH1C3)

# Exponential Smoothing 
es.HH1C3 = ses(HH1C3_w.train.ts, h = 28)
es.HH1C3$mean
es.HH1C3_df <- data.frame(es.HH1C3)
rownames(es.HH1C3_df) <- date_decimal(as.numeric(rownames(es.HH1C3_df)))
acc.es.HH1C3 <- accuracy(es.HH1C3, HH1C3_w.valid.ts)
knitr::kable(acc.es.HH1C3)
plot(es.HH1C3)

# Moving Average
ma.HH1C3 <- forecast(ma(HH1C3_w.train.ts, order = 5), h = 28)
ma.HH1C3$mean
ma.HH1C3_df <- data.frame(ma.HH1C3)
rownames(ma.HH1C3_df) <- date_decimal(as.numeric(rownames(ma.HH1C3_df)))
acc.ma.HH1C3 <- accuracy(ma.HH1C3, HH1C3_w.valid.ts)
knitr::kable(acc.ma.HH1C3)
plot(ma.HH1C3)

# SARIMA
sarima.HH1C3 <- forecast(auto.arima(HH1C3_w.train.ts, D = 1), h = 28)
sarima.HH1C3$mean
sarima.HH1C3_df <- data.frame(sarima.HH1C3)
rownames(sarima.HH1C3_df) <- date_decimal(as.numeric(rownames(sarima.HH1C3_df)))
acc.sarima.HH1C3 <- accuracy(sarima.HH1C3, HH1C3_w.valid.ts)
knitr::kable(acc.sarima.HH1C3)
plot(sarima.HH1C3)

# Holt Winters
hw.HH1C3 <- forecast(HoltWinters(HH1C3_w.train.ts, seasonal = "additive"), h = 28)
hw.HH1C3$mean
hw.HH1C3.df <- data.frame(hw.HH1C3)
rownames(hw.HH1C3.df) <- date_decimal(as.numeric(rownames(hw.HH1C3.df)))
acc.hw.HH1C3 <- accuracy(hw.F1C3, HH1C3_w.valid.ts)
knitr::kable(acc.hw.HH1C3)
plot(hw.HH1C3)


# State Space (Tbats)
tbats.HH1C3 <- forecast(tbats(HH1C3_w.train.ts), h = 28)
tbats.HH1C3$mean
tbats.HH1C3.df <- data.frame(tbats.HH1C3)
rownames(tbats.HH1C3.df) <- date_decimal(as.numeric(rownames(tbats.HH1C3.df)))
acc.tbats.HH1C3 <- accuracy(tbats.HH1C3, HH1C3_w.valid.ts)
knitr::kable(acc.tbats.HH1C3)
plot(tbats.HH1C3)
```


```{r}

# create a time series forecasting for the HH2 CA1 data
HH2C1_w <- ts(weekly_df$wd_HH2C1, start= 2011, frequency = 52)
time = time(HH2C1_w)

# validation set is 10% of the data set
n.valid <- 28
n.train <- length(HH2C1_w) - n.valid
HH2C1_w.train.ts <- window(HH2C1_w, start=time[1], end=time[n.train])
HH2C1_w.valid.ts <- window(HH2C1_w, start=time[n.train+1], end=time[n.train+n.valid])

# Naive Hobbies 
naive.HH2C1 = naive(HH2C1_w.train.ts, h= 28)
naive.HH2C1$mean
naive.HH2C1_df = data.frame(naive.HH2C1)
rownames(naive.HH2C1_df) = date_decimal(as.numeric(rownames(naive.HH2C1_df)))
acc.naive.HH2C1 <- accuracy(naive.HH2C1, HH2C1_w.valid.ts)
knitr::kable(acc.naive.HH2C1)
plot(naive.HH2C1)

# Seasonal Naive Hobbies 
snaive.HH2C1 = snaive(HH2C1_w.train.ts, h= 28)
snaive.HH2C1$mean
snaive.HH2C1_df = data.frame(snaive.HH2C1)
rownames(snaive.HH2C1_df) = date_decimal(as.numeric(rownames(snaive.HH2C1_df)))
acc.snaive.HH2C1 <- accuracy(snaive.HH2C1, HH2C1_w.valid.ts)
knitr::kable(acc.snaive.HH2C1)
plot(snaive.HH2C1)

# Exponential Smoothing 
es.HH2C1 = ses(HH2C1_w.train.ts, h = 28)
es.HH2C1$mean
es.HH2C1_df <- data.frame(es.HH2C1)
rownames(es.HH2C1_df) <- date_decimal(as.numeric(rownames(es.HH2C1_df)))
acc.es.HH2C1 <- accuracy(es.HH2C1, HH2C1_w.valid.ts)
knitr::kable(acc.es.HH2C1)
plot(es.HH2C1)

# Moving Average
ma.HH2C1 <- forecast(ma(HH2C1_w.train.ts, order = 5), h = 28)
ma.HH2C1$mean
ma.HH2C1_df <- data.frame(ma.HH2C1)
rownames(ma.HH2C1_df) <- date_decimal(as.numeric(rownames(ma.HH2C1_df)))
acc.ma.HH2C1 <- accuracy(ma.HH2C1, HH2C1_w.valid.ts)
knitr::kable(acc.ma.HH2C1)
plot(ma.HH2C1)

# SARIMA
sarima.HH2C1 <- forecast(auto.arima(HH2C1_w.train.ts, D = 1), h = 28)
sarima.HH2C1$mean
sarima.HH2C1_df <- data.frame(sarima.HH2C1)
rownames(sarima.HH2C1_df) <- date_decimal(as.numeric(rownames(sarima.HH2C1_df)))
acc.sarima.HH2C1 <- accuracy(sarima.HH2C1, HH2C1_w.valid.ts)
knitr::kable(acc.sarima.HH2C1)
plot(sarima.HH2C1)

# Holt Winters
hw.HH2C1 <- forecast(HoltWinters(HH2C1_w.train.ts, seasonal = "additive"), h = 28)
hw.HH2C1$mean
hw.HH2C1.df <- data.frame(hw.HH2C1)
rownames(hw.HH2C1.df) <- date_decimal(as.numeric(rownames(hw.HH2C1.df)))
acc.hw.HH2C1 <- accuracy(hw.F1C1, HH2C1_w.valid.ts)
knitr::kable(acc.hw.HH2C1)
plot(hw.HH2C1)



# State Space (Tbats)
tbats.HH2C1 <- forecast(tbats(HH2C1_w.train.ts), h = 28)
tbats.HH2C1$mean
tbats.HH2C1.df <- data.frame(tbats.HH2C1)
rownames(tbats.HH2C1.df) <- date_decimal(as.numeric(rownames(tbats.HH2C1.df)))
acc.tbats.HH2C1 <- accuracy(tbats.HH2C1, HH2C1_w.valid.ts)
knitr::kable(acc.tbats.HH2C1)
plot(tbats.HH2C1)
```
```{r}
# create a time series forecasting for the HH2 CA2 data
HH2C2_w <- ts(weekly_df$wd_HH2C2, start= 2011, frequency = 52)
time = time(HH2C2_w)

# validation set is 10% of the data set
n.valid <- 28
n.train <- length(HH2C2_w) - n.valid
HH2C2_w.train.ts <- window(HH2C2_w, start=time[1], end=time[n.train])
HH2C2_w.valid.ts <- window(HH2C2_w, start=time[n.train+1], end=time[n.train+n.valid])

# Naive Hobbies 
naive.HH2C2 = naive(HH2C2_w.train.ts, h= 28)
naive.HH2C2$mean
naive.HH2C2_df = data.frame(naive.HH2C2)
rownames(naive.HH2C2_df) = date_decimal(as.numeric(rownames(naive.HH2C2_df)))
acc.naive.HH2C2 <- accuracy(naive.HH2C2, HH2C2_w.valid.ts)
knitr::kable(acc.naive.HH2C2)
plot(naive.HH2C2)

# Seasonal Naive Hobbies 
snaive.HH2C2 = snaive(HH2C2_w.train.ts, h= 28)
snaive.HH2C2$mean
snaive.HH2C2_df = data.frame(snaive.HH2C2)
rownames(snaive.HH2C2_df) = date_decimal(as.numeric(rownames(snaive.HH2C2_df)))
acc.snaive.HH2C2 <- accuracy(snaive.HH2C2, HH2C2_w.valid.ts)
knitr::kable(acc.snaive.HH2C2)
plot(snaive.HH2C2)

# Exponential Smoothing 
es.HH2C2 = ses(HH2C2_w.train.ts, h = 28)
es.HH2C2$mean
es.HH2C2_df <- data.frame(es.HH2C2)
rownames(es.HH2C2_df) <- date_decimal(as.numeric(rownames(es.HH2C2_df)))
acc.es.HH2C2 <- accuracy(es.HH2C2, HH2C2_w.valid.ts)
knitr::kable(acc.es.HH2C2)
plot(es.HH2C2)

# Moving Average
ma.HH2C2 <- forecast(ma(HH2C2_w.train.ts, order = 5), h = 28)
ma.HH2C2$mean
ma.HH2C2_df <- data.frame(ma.HH2C2)
rownames(ma.HH2C2_df) <- date_decimal(as.numeric(rownames(ma.HH2C2_df)))
acc.ma.HH2C2 <- accuracy(ma.HH2C2, HH2C2_w.valid.ts)
knitr::kable(acc.ma.HH2C2)
plot(ma.HH2C2)

# SARIMA
sarima.HH2C2 <- forecast(auto.arima(HH2C2_w.train.ts, D = 1), h = 28)
sarima.HH2C2$mean
sarima.HH2C2_df <- data.frame(sarima.HH2C2)
rownames(sarima.HH2C2_df) <- date_decimal(as.numeric(rownames(sarima.HH2C2_df)))
acc.sarima.HH2C2 <- accuracy(sarima.HH2C2, HH2C2_w.valid.ts)
knitr::kable(acc.sarima.HH2C2)
plot(sarima.HH2C2)

# Holt Winters
hw.HH2C2 <- forecast(HoltWinters(HH2C2_w.train.ts, seasonal = "additive"), h = 28)
hw.HH2C2$mean
hw.HH2C2.df <- data.frame(hw.HH2C2)
rownames(hw.HH2C2.df) <- date_decimal(as.numeric(rownames(hw.HH2C2.df)))
acc.hw.HH2C2 <- accuracy(hw.F1C2, HH2C2_w.valid.ts)
knitr::kable(acc.hw.HH2C2)
plot(hw.HH2C2)



# State Space (Tbats)
tbats.HH2C2 <- forecast(tbats(HH2C2_w.train.ts), h = 28)
tbats.HH2C2$mean
tbats.HH2C2.df <- data.frame(tbats.HH2C2)
rownames(tbats.HH2C2.df) <- date_decimal(as.numeric(rownames(tbats.HH2C2.df)))
acc.tbats.HH2C2 <- accuracy(tbats.HH2C2, HH2C2_w.valid.ts)
knitr::kable(acc.tbats.HH2C2)
plot(tbats.HH2C2)
```

```{r}

# create a time series forecasting for the HH2 CA3 data
HH2C3_w <- ts(weekly_df$wd_HH2C3, start= 2011, frequency = 52)
time = time(HH2C3_w)

# validation set is 10% of the data set
n.valid <- 28
n.train <- length(HH2C3_w) - n.valid
HH2C3_w.train.ts <- window(HH2C3_w, start=time[1], end=time[n.train])
HH2C3_w.valid.ts <- window(HH2C3_w, start=time[n.train+1], end=time[n.train+n.valid])

# Naive Hobbies 
naive.HH2C3 = naive(HH2C3_w.train.ts, h= 28)
naive.HH2C3$mean
naive.HH2C3_df = data.frame(naive.HH2C3)
rownames(naive.HH2C3_df) = date_decimal(as.numeric(rownames(naive.HH2C3_df)))
acc.naive.HH2C3 <- accuracy(naive.HH2C3, HH2C3_w.valid.ts)
knitr::kable(acc.naive.HH2C3)
plot(naive.HH2C3)

# Seasonal Naive Hobbies 
snaive.HH2C3 = snaive(HH2C3_w.train.ts, h= 28)
snaive.HH2C3$mean
snaive.HH2C3_df = data.frame(snaive.HH2C3)
rownames(snaive.HH2C3_df) = date_decimal(as.numeric(rownames(snaive.HH2C3_df)))
acc.snaive.HH2C3 <- accuracy(snaive.HH2C3, HH2C3_w.valid.ts)
knitr::kable(acc.snaive.HH2C3)
plot(snaive.HH2C3)

# Exponential Smoothing 
es.HH2C3 = ses(HH2C3_w.train.ts, h = 28)
es.HH2C3$mean
es.HH2C3_df <- data.frame(es.HH2C3)
rownames(es.HH2C3_df) <- date_decimal(as.numeric(rownames(es.HH2C3_df)))
acc.es.HH2C3 <- accuracy(es.HH2C3, HH2C3_w.valid.ts)
knitr::kable(acc.es.HH2C3)
plot(es.HH2C3)

# Moving Average
ma.HH2C3 <- forecast(ma(HH2C3_w.train.ts, order = 5), h = 28)
ma.HH2C3$mean
ma.HH2C3_df <- data.frame(ma.HH2C3)
rownames(ma.HH2C3_df) <- date_decimal(as.numeric(rownames(ma.HH2C3_df)))
acc.ma.HH2C3 <- accuracy(ma.HH2C3, HH2C3_w.valid.ts)
knitr::kable(acc.ma.HH2C3)
plot(ma.HH2C3)

# SARIMA
sarima.HH2C3 <- forecast(auto.arima(HH2C3_w.train.ts, D = 1), h = 28)
sarima.HH2C3$mean
sarima.HH2C3_df <- data.frame(sarima.HH2C3)
rownames(sarima.HH2C3_df) <- date_decimal(as.numeric(rownames(sarima.HH2C3_df)))
acc.sarima.HH2C3 <- accuracy(sarima.HH2C3, HH2C3_w.valid.ts)
knitr::kable(acc.sarima.HH2C3)
plot(sarima.HH2C3)

# Holt Winters
hw.HH2C3 <- forecast(HoltWinters(HH2C3_w.train.ts, seasonal = "additive"), h = 28)
hw.HH2C3$mean
hw.HH2C3.df <- data.frame(hw.HH2C3)
rownames(hw.HH2C3.df) <- date_decimal(as.numeric(rownames(hw.HH2C3.df)))
acc.hw.HH2C3 <- accuracy(hw.F1C3, HH2C3_w.valid.ts)
knitr::kable(acc.hw.HH2C3)
plot(hw.HH2C3)



# State Space (Tbats)
tbats.HH2C3 <- forecast(tbats(HH2C3_w.train.ts), h = 28)
tbats.HH2C3$mean
tbats.HH2C3.df <- data.frame(tbats.HH2C3)
rownames(tbats.HH2C3.df) <- date_decimal(as.numeric(rownames(tbats.HH2C3.df)))
acc.tbats.HH2C3 <- accuracy(tbats.HH2C3, HH2C3_w.valid.ts)
knitr::kable(acc.tbats.HH2C3)
plot(tbats.HH2C3)
```

################################################################################
Exercise 2. Multivariate Models

We now consider fitting multivariate models and, in each case, comparing them with the univariate benchmarks obtained in Section 1 as well as between themselves. Assessments are made at the h = 1 horizon for point & probabilistic forecasts.

2.1. Consider a VAR model for each store and obtain resulting forecasts for the testing sample
```{r}
install.packages("vars")
install.packages("mFilter")
install.packages("TSstudio")
```
```{r}
library(vars)
library(mFilter)
library(tseries)
library(TSstudio)
library(forecast)
library(tidyverse)

# https://towardsdatascience.com/a-deep-dive-on-vector-autoregression-in-r-58767ebb3f06?gi=b439b180190c
ex2 <- stores_data
ex2_CA1 <- ts(ex2$CA1, start = c(2011,1,29), frequency = 365)
ex2_CA2 <- ts(ex2$CA1, start = c(2011,1,29), frequency = 365)
ex2_CA3 <- ts(ex2$CA1, start = c(2011,1,29), frequency = 365)

v1 <- cbind(ex2_CA1,ex2_CA2,ex2_CA3)
colnames(v1) <- cbind("CA1", "CA2", "CA3")

# Automatically generate preferred lag order
lagselect <- VARselect(v1, lag.max = 15, type = "const")
lagselect$selection
Model1 <- VAR(v1, p = 1, type = "const", season = NULL, exog = NULL) 

# Test that residuals are non-autocorrelated
Serial1 <- serial.test(Model1, lags.pt = 5, type = "PT.asymptotic")
Serial1

# lag length
#VARselect(ex2.lev, lag.max = 4,
#          type = "const", season = 4)
 
# estimation
#ar.model_lev <- VAR(df.lev, p = 2, 
#                    type = "const", season = 4)
 
# forecast of lev data
#var.pred <-  predict(var.model_lev, n.ahead = nhor)

```
2.2. Consider a VAR model for each type of products and obtain forecasts.

2.3. Consider a large VAR model involving all variables.




################################################################################
Exercise 3. Machine/Deep Learning models and extension 


3.1. Now consider machine learning benchmarks, such as those in the set of benchmarks or that are available on the M5 github (e.g. LSTM, using keras in R) and compare their performance in terms of point/probabilistic forecasts. 

When analyzing the scores and ranks of the M5 competition, we can find information about the Accuracy-Benchmarks as well as the Uncertainty-Benchmarks. There are 24 methods being used for point forecasts and 6 methods for probabilistic forecasts. Furthermore, the information is provided in 12 different levels of aggregation starting with the one time series containing the unit sales that is later on aggregated by state, store, category, department, product and a combination leading to a 30.490 time series in level 12 (L12). Finally, the average of all 42.840 time series is taking and provided in the final column of the benchmarks. 

In the following we want to first analyze the performance of the individual algorithms and compare their benchmarks with the achieved results from the highest-ranking teams to assess what approaches lead to the highest performance.

Starting with the Accuracy-Benchmarks, the performance of point forecasts of the individual methods is measured using the Root Mean Squared Scaled Error (WRMSSE). Overall, we can see that the WRMSSE increases with the level and the number of time series to consider. The models that achieve the lowest WRMSSE in the first 9 levels are the statistical benchmarks Exponential Smoothing in a Bottom-Up approach (ES_bu) and Exponential Smoothing with explanatory Variables (ESX). For the larger number of time series in the levels 10, 11 and 12 we can observe that the performance varies less than in the previous levels with the lowest error being reached by using combination benchmarks of averaging both Exponential Smoothing methods in a top-down and bottom-up approach (Com_tb). On average, the ES_bu method gives the lowest error and thus displays the top-performing and most interesting benchmark to consider.

The Top 50 teams of the competition all outperformed the ES_bu benchmark with the Top 5 teams achieving higher accuracies by over 20% and the winning team achieving 22.4% improvement over ES_bu. Thus, the approaches of the top 5 teams could have high impacts and create a lot of economic value when used in practice. It is evident, that the performance vastly differs among the aggregation level. Some teams perform better in some levels while lacking accuracy in comparison in other levels. The winning team performed best in the levels L3, L7, L8, L9 while only coming 13th in L10, 12th in L11 and 11th in L12. The second place received impressive results in lower levels, winning L2, L4, L5 and L6, but performed worse in L10, L11 and L12 only barely making a Top 50 accuracy in these aggregation levels. Thus, we can conclude that different methods are more or less useful depending on the forecasting task and to optimize accuracy the entire scope of the values has to be taken into account. We also notice that compared to ES_bu the accuracy in the lower levels is on average more improved than in the higher levels with more time series to consider.

When assessing the different methods, the teams have used to receive the results with the highest performance for point forecasts, it becomes clear that most of the teams have used gradient boosting ML algorithms. Especially LightGBM, which is a nonlinear regression algorithm using gradient boosted trees, is used for the top placements in the competition. The submissions of the top placements combined various LightGBM models using different recursive and non-recursive learning approaches and training sets, for example per store or department, that were fine-tuned using numerous parameters and features.

When we analyze the Uncertainty-Benchmarks, the performance of probabilistic forecast is evaluated using the Scaled Pinball Loss function calculated at nine quantiles, averaged and ranked using the Weighted Scaled Pinball Loss function (WSPL). Again, for the highest performing benchmarks we can see the WSPL error slightly increase with the level and the number of time series to be estimated. The AutoRegressive Integrated Moving Average (ARIMA) and Exponential smoothing (ETS) benchmarks, both similar to the Bottom-Up approach for point forecasts, give the best performance among the probabilistic methods over all levels as well as all quantiles. On average they give almost the same results with the ARIMA method slightly outperforming ETS by 0.001 and thus is the benchmark to beat for the submissions. As the coverage rate for all of the benchmarks fits quite well for most of the quantiles, and the first 10 submissions in the Uncertainty Ranking among the Top 50 submissions received bad placements in terms of coverage rage, the coverage rate will be neglected for the purpose of this analysis.

3.2. Can combinations of ML/DL techniques with standard techniques help? 

In the M5 competition the highest ranked submissions consisted solely of ML methods and vastly outperformed statistical benchmarks and their combinations. Due to advancements in data availability, efficiency of algorithms, preprocessing and computational power, ML methods provide more promising results as evidenced by the improved accuracy of the WRMSSE of over 20 % over all statistical benchmarks. Even with only smaller improvements for less aggregated time series, ML forecasting methods should be considered as todayâ€™s most promising approach to estimate the complex, non-linear relationships within the data. Next to gradient boosting methods like LightGBM can Deep Learning methods further optimize results and provide potential to outperform other ML algorithms. 

The approach of combining numerous methods to achieve more accurate estimations has been proving valuable for a long time. Already the combination of statistical benchmarks showed promising results and almost all the results of the Top 50 submissions use combination of techniques improve their accuracy and exploit different learning approaches and training sets to receive the targeted placements. Following the results of the Top 50 submissions we can also see that using the correlation between the series allows achieving more accurate results compared to methods without cross-learning by taking all the information of the dataset into consideration.

The combination of ML/DL technique with standard techniques becomes then interesting when external information from domain knowledge and forecasting knowledge comes into play to externally adjust the forecasts, reducing bias and including long-term trends by using special weights and multipliers for certain ML models. Furthermore, time series methods can identify patterns in historic data, especially those reliant on exogenous and explanatory variables such as holidays, promotion and prices etc. can help observe patterns that could distort historical data. After removing the pattern-generating data, the forecast can further reach higher accuracies.

Nevertheless, most high-ranking submissions focused primarily the use of unstructured data-driven methods using cross-validation and rather focused on building numerous models than finding the most accurate model using a certain statistical method or a combination of such. Instead of understanding the data in depth and applying statistical and forecasting knowledge, the improved accuracy came through experimentation and data mining. Thus, we conclude that standard techniques can help to improve the accuracy of the results but the computational-heavy implementation and fine tuning of numerous ML/DL methods proves to be more effective if solely improved accuracy instead of explainability is the target. 

